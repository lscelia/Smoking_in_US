<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="Wanxin Qi" />


<title>Smoking and Covid-19</title>

<script src="site_libs/header-attrs-2.10/header-attrs.js"></script>
<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/cosmo.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet" />
<link href="site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet" />

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>








<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.tab('show');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->




</head>

<body>


<div class="container-fluid main-container">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Home</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="about.html">About</a>
</li>
<li>
  <a href="mailto:##Email">
    <span class="fa fa-envelope fa-lg"></span>
     
  </a>
</li>
<li>
  <a>
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">



<h1 class="title toc-ignore">Smoking and Covid-19</h1>
<h4 class="author">Wanxin Qi</h4>
<h4 class="date">12/7/2021</h4>

</div>


<div id="import-and-clean-data-from-nhis" class="section level2">
<h2>Import and Clean Data From NHIS</h2>
<pre class="r"><code>adult_19 = 
  read_csv(&quot;data/adult19.csv&quot;) %&gt;%
  select(SEX_A, AGEP_A, SMKCIGST_A, PHSTAT_A, EDUC_A, ORIENT_A, HISPALLP_A, HISDETP_A, DISAB3_A, BMICAT_A, CANEV_A, DIBEV_A, DIBTYPE_A, DEMENEV_A, CHDEV_A, PREGNOW_A, ASTILL_A, STREV_A, HYPEV_A, COPDEV_A, ANXEV_A, DEPEV_A) %&gt;%
  mutate(YEAR = 2019,
         HLTHCOND_A = NA
         ) %&gt;%
  relocate(YEAR)

adult_20 = 
  read_csv(&quot;data/adult20.csv&quot;) %&gt;%
  select(SEX_A, AGEP_A, SMKCIGST_A, PHSTAT_A, EDUC_A, ORIENT_A, HISPALLP_A, HISDETP_A, DISAB3_A, BMICAT_A, CANEV_A, DIBEV_A, DIBTYPE_A, DEMENEV_A, CHDEV_A, PREGNOW_A, ASTILL_A, STREV_A, HYPEV_A, COPDEV_A, ANXEV_A, DEPEV_A, HLTHCOND_A) %&gt;%
  mutate(YEAR = 2020) %&gt;%
  relocate(YEAR)

adult = rbind(adult_19, adult_20)</code></pre>
<pre class="r"><code>adult =
  adult %&gt;%
  janitor::clean_names() %&gt;%
  mutate(
    sex = case_when(
      sex_a == &quot;1&quot; ~ &quot;male&quot;,
      sex_a == &quot;2&quot; ~ &quot;female&quot;,
      sex_a == &quot;7&quot; ~ &quot;refused&quot;,
      sex_a == &quot;8&quot; ~ &quot;not ascertained&quot;,
      sex_a == &quot;9&quot; ~ &quot;don&#39;t know&quot;
    ),
    
    age = agep_a,
    
    smoke = case_when(
      smkcigst_a == &quot;1&quot; ~ &quot;current every day smoker&quot;,
      smkcigst_a == &quot;2&quot; ~ &quot;current some day smoker&quot;,
      smkcigst_a == &quot;3&quot; ~ &quot;former smoker&quot;,
      smkcigst_a == &quot;4&quot; ~ &quot;never smoker&quot;,
      smkcigst_a == &quot;5&quot; ~ &quot;smoker, current status unknown&quot;,
      smkcigst_a == &quot;9&quot; ~ &quot;unknown if ever smoked&quot;
    ),

    education = case_when(
      educ_a == &quot;0&quot; ~ &quot;never attended/kindergarten only&quot;,
      educ_a == &quot;1&quot; ~ &quot;grade 1-11&quot;,
      educ_a == &quot;2&quot; ~ &quot;12th grade, no diploma&quot;,
      educ_a == &quot;3&quot; ~ &quot;GED or equivalent&quot;,
      educ_a == &quot;4&quot; ~ &quot;high school graduate&quot;,
      educ_a == &quot;5&quot; ~ &quot;some college, no degree&quot;,
      educ_a == &quot;6&quot; ~ &quot;associate degree: occupational...&quot;,
      educ_a == &quot;7&quot; ~ &quot;associate degree: academic&quot;,
      educ_a == &quot;8&quot; ~ &quot;bachelor&#39;s degree&quot;,
      educ_a == &quot;9&quot; ~ &quot;master&#39;s degree&quot;,
      educ_a == &quot;10&quot; ~ &quot;professional school&quot;,
      educ_a == &quot;11&quot; ~ &quot;doctoral degree&quot;,
      educ_a == &quot;97&quot; ~ &quot;refused&quot;,
      educ_a == &quot;98&quot; ~ &quot;not ascertained&quot;,
      educ_a == &quot;99&quot; ~ &quot;don&#39;t know&quot;
    ),
    
    race = case_when(
      hispallp_a == &quot;1&quot; ~ &quot;hispanic&quot;,
      hispallp_a == &quot;2&quot; ~ &quot;white&quot;,
      hispallp_a == &quot;3&quot; ~ &quot;black or african american&quot;,
      hispallp_a == &quot;4&quot; ~ &quot;asian&quot;,
      hispallp_a == &quot;5&quot; ~ &quot;aian&quot;,
      hispallp_a == &quot;6&quot; ~ &quot;aian and other&quot;,
      hispallp_a == &quot;7&quot; ~ &quot;multiple races&quot;,
      hispallp_a == &quot;97&quot; ~ &quot;refused&quot;,
      hispallp_a == &quot;98&quot; ~ &quot;not ascertained&quot;,
      hispallp_a == &quot;99&quot; ~ &quot;don&#39;t know&quot;
    ),
    
    hispanic_origin = case_when(
      hisdetp_a == &quot;1&quot; ~ &quot;mexican&quot;,
      hisdetp_a == &quot;2&quot; ~ &quot;other hispanic&quot;,
      hisdetp_a == &quot;3&quot; ~ &quot;not hispanic&quot;,
      hisdetp_a == &quot;7&quot; ~ &quot;refused&quot;,
      hisdetp_a == &quot;8&quot; ~ &quot;not ascertained&quot;,
      hisdetp_a == &quot;9&quot; ~ &quot;don&#39;t know&quot;
    ),
    
    disability = case_when(
      disab3_a == &quot;1&quot; ~ &quot;yes&quot;,
      disab3_a == &quot;2&quot; ~ &quot;no&quot;,
      disab3_a == &quot;9&quot; ~ &quot;don&#39;t know&quot;
    ),
    
    health = case_when(
      phstat_a == &quot;1&quot; ~ &quot;excellent&quot;,
      phstat_a == &quot;2&quot; ~ &quot;very good&quot;,
      phstat_a == &quot;3&quot; ~ &quot;good&quot;,
      phstat_a == &quot;4&quot; ~ &quot;fair&quot;,
      phstat_a == &quot;5&quot; ~ &quot;poor&quot;,
      phstat_a == &quot;7&quot; ~ &quot;refused&quot;,
      phstat_a == &quot;8&quot; ~ &quot;not ascertained&quot;,
      phstat_a == &quot;9&quot; ~ &quot;don&#39;t know&quot;
    ),
    
    orient = case_when(
      orient_a == &quot;1&quot; ~ &quot;gaylesbian&quot;,
      orient_a == &quot;2&quot; ~ &quot;straight&quot;,
      orient_a == &quot;3&quot; ~ &quot;bisexual&quot;,
      orient_a == &quot;4&quot; ~ &quot;else&quot;,
      orient_a == &quot;5&quot; ~ &quot;unknown&quot;,
      orient_a == &quot;7&quot; ~ &quot;refused&quot;,
      orient_a == &quot;8&quot; ~ &quot;not ascertained&quot;,
      orient_a == &quot;9&quot; ~ &quot;don&#39;t know&quot;
    ),
    
    bmi = case_when(
      bmicat_a == &quot;1&quot; ~ &quot;underweight&quot;,
      bmicat_a == &quot;2&quot; ~ &quot;healthy weight&quot;,
      bmicat_a == &quot;3&quot; ~ &quot;overweight&quot;,
      bmicat_a == &quot;4&quot; ~ &quot;obese&quot;,
      bmicat_a == &quot;9&quot; ~ &quot;unknown&quot;
    ),
    
    cancer = case_when(
      canev_a == &quot;1&quot; ~ &quot;yes&quot;,
      canev_a == &quot;2&quot; ~ &quot;no&quot;,
      canev_a == &quot;7&quot; ~ &quot;refused&quot;,
      canev_a == &quot;8&quot; ~ &quot;not ascertained&quot;,
      canev_a == &quot;9&quot; ~ &quot;don&#39;t know&quot;
    ),

    diabetes_type = case_when(
      dibtype_a == &quot;1&quot; ~ &quot;type 1&quot;,
      dibtype_a == &quot;2&quot; ~ &quot;type 2&quot;,
      dibtype_a == &quot;3&quot; ~ &quot;other&quot;,
      dibtype_a == &quot;7&quot; ~ &quot;refused&quot;,
      dibtype_a == &quot;8&quot; ~ &quot;not ascertained&quot;,
      dibtype_a == &quot;9&quot; ~ &quot;don&#39;t know&quot;
    ),
    
    dementia = case_when(
      demenev_a == &quot;1&quot; ~ &quot;yes&quot;,
      demenev_a == &quot;2&quot; ~ &quot;no&quot;,
      demenev_a == &quot;7&quot; ~ &quot;refused&quot;,
      demenev_a == &quot;8&quot; ~ &quot;not ascertained&quot;,
      demenev_a == &quot;9&quot; ~ &quot;don&#39;t know&quot;
    ),
    
    heart_disease = case_when(
      chdev_a == &quot;1&quot; ~ &quot;yes&quot;,
      chdev_a == &quot;2&quot; ~ &quot;no&quot;,
      chdev_a == &quot;7&quot; ~ &quot;refused&quot;,
      chdev_a == &quot;8&quot; ~ &quot;not ascertained&quot;,
      chdev_a == &quot;9&quot; ~ &quot;don&#39;t know&quot;
    ),
    
    asthma = case_when(
      astill_a == &quot;1&quot; ~ &quot;yes&quot;,
      astill_a == &quot;2&quot; ~ &quot;no&quot;,
      astill_a == &quot;7&quot; ~ &quot;refused&quot;,
      astill_a == &quot;8&quot; ~ &quot;not ascertained&quot;,
      astill_a == &quot;9&quot; ~ &quot;don&#39;t know&quot;
    ),
    
    stroke = case_when(
      strev_a == &quot;1&quot; ~ &quot;yes&quot;,
      strev_a == &quot;2&quot; ~ &quot;no&quot;,
      strev_a == &quot;7&quot; ~ &quot;refused&quot;,
      strev_a == &quot;8&quot; ~ &quot;not ascertained&quot;,
      strev_a == &quot;9&quot; ~ &quot;don&#39;t know&quot;
    ),
    
    hypertention = case_when(
      hypev_a == &quot;1&quot; ~ &quot;yes&quot;,
      hypev_a == &quot;2&quot; ~ &quot;no&quot;,
      hypev_a == &quot;7&quot; ~ &quot;refused&quot;,
      hypev_a == &quot;8&quot; ~ &quot;not ascertained&quot;,
      hypev_a == &quot;9&quot; ~ &quot;don&#39;t know&quot;
    ),
    
    copd = case_when(
      copdev_a == &quot;1&quot; ~ &quot;yes&quot;,
      copdev_a == &quot;2&quot; ~ &quot;no&quot;,
      copdev_a == &quot;7&quot; ~ &quot;refused&quot;,
      copdev_a == &quot;8&quot; ~ &quot;not ascertained&quot;,
      copdev_a == &quot;9&quot; ~ &quot;don&#39;t know&quot;
    ),
    
    anxiety = case_when(
      anxev_a == &quot;1&quot; ~ &quot;yes&quot;,
      anxev_a == &quot;2&quot; ~ &quot;no&quot;,
      anxev_a == &quot;7&quot; ~ &quot;refused&quot;,
      anxev_a == &quot;8&quot; ~ &quot;not ascertained&quot;,
      anxev_a == &quot;9&quot; ~ &quot;don&#39;t know&quot;
    ),
    
    depression = case_when(
      depev_a == &quot;1&quot; ~ &quot;yes&quot;,
      depev_a == &quot;2&quot; ~ &quot;no&quot;,
      depev_a == &quot;7&quot; ~ &quot;refused&quot;,
      depev_a == &quot;8&quot; ~ &quot;not ascertained&quot;,
      depev_a == &quot;9&quot; ~ &quot;don&#39;t know&quot;
    ),
    
    pregnant = case_when(
      pregnow_a == &quot;1&quot; ~ &quot;yes&quot;,
      pregnow_a == &quot;2&quot; ~ &quot;no&quot;,
      pregnow_a == &quot;7&quot; ~ &quot;refused&quot;,
      pregnow_a == &quot;8&quot; ~ &quot;not ascertained&quot;,
      pregnow_a == &quot;9&quot; ~ &quot;don&#39;t know&quot;
    ),
    
    immune_weaken = case_when(
      hlthcond_a == &quot;1&quot; ~ &quot;yes&quot;,
      hlthcond_a == &quot;2&quot; ~ &quot;no&quot;,
      hlthcond_a == &quot;7&quot; ~ &quot;refused&quot;,
      hlthcond_a == &quot;8&quot; ~ &quot;not ascertained&quot;,
      hlthcond_a == &quot;9&quot; ~ &quot;don&#39;t know&quot;
    )
  )

adult = adult %&gt;%
  select(-sex_a, -agep_a, -smkcigst_a, -phstat_a, -educ_a, -hispallp_a, -hisdetp_a, -orient_a, -bmicat_a, -canev_a, -dibev_a, -dibtype_a, -copdev_a, -hypev_a, -strev_a, -astill_a, -chdev_a, -demenev_a, -hlthcond_a, -pregnow_a, -depev_a, -anxev_a, -disab3_a) %&gt;%
  relocate(year, smoke, sex, age, orient, education, race, hispanic_origin, disability, health, cancer, asthma, copd, dementia, diabetes_type, heart_disease, hypertention, anxiety, depression, bmi, pregnant, stroke, immune_weaken) %&gt;%
  mutate(
    diabetes_type = replace(diabetes_type, is.na(diabetes_type), &quot;missing&quot;),
    asthma = replace(asthma, is.na(asthma), &quot;missing&quot;),
    pregnant = replace(pregnant, is.na(pregnant), &quot;missing&quot;),
    immune_weaken = replace(immune_weaken, is.na(immune_weaken), &quot;missing&quot;)
  )</code></pre>
<pre class="r"><code>adult_smoke = 
  adult %&gt;%
  filter(smoke %in% c(&quot;current every day smoker&quot;, &quot;current some day smoker&quot;, &quot;former smoker&quot;, &quot;never smoker&quot;)) %&gt;%
  mutate(
    smoke = recode(smoke, &quot;current every day smoker&quot; = &quot;current smoker&quot;, &quot;current some day smoker&quot; = &quot;current smoker&quot;)
  ) %&gt;%
  mutate(
    sex = as.factor(sex),
    smoke = as.factor(smoke),
    orient = as.factor(orient),
    education = as.factor(education),
    race = as.factor(race),
    hispanic_origin = as.factor(hispanic_origin),
    disability = as.factor(disability),
    health = as.factor(health), 
    cancer = as.factor(cancer), 
    asthma = as.factor(asthma), 
    copd = as.factor(copd), 
    dementia = as.factor(dementia), 
    diabetes_type = as.factor(dementia), 
    heart_disease = as.factor(heart_disease), 
    hypertention = as.factor(hypertention), 
    anxiety = as.factor(anxiety), 
    depression = as.factor(depression), 
    bmi = as.factor(bmi), 
    pregnant = as.factor(pregnant), 
    stroke = as.factor(stroke), 
    immune_weaken = as.factor(immune_weaken)
  ) %&gt;%
  mutate(
    smoke = fct_relevel(smoke, &quot;current smoker&quot;, &quot;former smoker&quot;, &quot;never smoker&quot;)
  )</code></pre>
<pre class="r"><code>adult=
  adult%&gt;%
  mutate(smoke = recode(smoke,&quot;never smoker&quot;=&quot;never smoker&quot;,
      &quot;current every day smoker&quot;=&quot;current smoker&quot;,
      &quot;current some day smoker&quot;=&quot;current smoker&quot;,
      &quot;former smoker&quot;=&quot;former smoker&quot;,
  ))%&gt;%
  filter(smoke %in% c(&quot;never smoker&quot;,&quot;current smoker&quot;,&quot;former smoker&quot;))

adult</code></pre>
<pre><code>## # A tibble: 62,179 × 23
##     year smoke  sex      age orient education  race   hispanic_origin disability
##    &lt;dbl&gt; &lt;chr&gt;  &lt;chr&gt;  &lt;dbl&gt; &lt;chr&gt;  &lt;chr&gt;      &lt;chr&gt;  &lt;chr&gt;           &lt;chr&gt;     
##  1  2019 never… male      97 strai… associate… black… not hispanic    no        
##  2  2019 curre… female    28 strai… associate… white  not hispanic    no        
##  3  2019 never… male      72 strai… some coll… white  not hispanic    no        
##  4  2019 never… male      60 strai… associate… hispa… other hispanic  no        
##  5  2019 curre… male      60 strai… some coll… white  not hispanic    no        
##  6  2019 never… male      78 strai… some coll… black… not hispanic    no        
##  7  2019 never… male      32 strai… bachelor&#39;… white  not hispanic    no        
##  8  2019 curre… male      61 strai… high scho… white  not hispanic    no        
##  9  2019 never… male      28 strai… some coll… white  not hispanic    no        
## 10  2019 forme… male      85 strai… grade 1-11 white  not hispanic    no        
## # … with 62,169 more rows, and 14 more variables: health &lt;chr&gt;, cancer &lt;chr&gt;,
## #   asthma &lt;chr&gt;, copd &lt;chr&gt;, dementia &lt;chr&gt;, diabetes_type &lt;chr&gt;,
## #   heart_disease &lt;chr&gt;, hypertention &lt;chr&gt;, anxiety &lt;chr&gt;, depression &lt;chr&gt;,
## #   bmi &lt;chr&gt;, pregnant &lt;chr&gt;, stroke &lt;chr&gt;, immune_weaken &lt;chr&gt;</code></pre>
<pre class="r"><code>sex_df=
  adult%&gt;%
  group_by(smoke,sex)%&gt;%
  summarise(n=n())%&gt;%
  filter(sex%in%c(&quot;female&quot;,&quot;male&quot;))%&gt;%
  group_by(sex)%&gt;%
  mutate(sum=sum(n))%&gt;%
  mutate(percentage=n/sum)


sex_df</code></pre>
<pre><code>## # A tibble: 6 × 5
## # Groups:   sex [2]
##   smoke          sex        n   sum percentage
##   &lt;chr&gt;          &lt;chr&gt;  &lt;int&gt; &lt;int&gt;      &lt;dbl&gt;
## 1 current smoker female  3847 33533      0.115
## 2 current smoker male    4061 28641      0.142
## 3 former smoker  female  7520 33533      0.224
## 4 former smoker  male    8593 28641      0.300
## 5 never smoker   female 22166 33533      0.661
## 6 never smoker   male   15987 28641      0.558</code></pre>
<pre class="r"><code>ggplot(sex_df,aes(fill=smoke,x=sex,y=percentage))+
  geom_bar(position=&quot;stack&quot;, stat=&quot;identity&quot;)+
  labs(
    title=&quot;smokers by sex&quot;,
    x=&quot;sex&quot;,
    y=&quot;value&quot;
  )</code></pre>
<p><img src="smoking_and_covid19_files/figure-html/unnamed-chunk-1-1.png" width="90%" /></p>
<pre class="r"><code>education_df=
  adult%&gt;%
  group_by(smoke,education)%&gt;%
  summarise(n=n())%&gt;%
  filter(education%in%c(&quot;never attended/kindergarten only&quot;,&quot;grade 1-11&quot;,&quot;12th grade, no diploma&quot;,&quot;GED or equivalent&quot;,&quot;high school graduate&quot;,&quot;some college, no degree&quot;,&quot;associate degree:occupational...&quot;,&quot;associate degree: academic&quot;,&quot;bachelor&#39;s degree&quot;,&quot;doctoral degree&quot;))%&gt;%
  group_by(education)%&gt;%
  mutate(sum=sum(n))%&gt;%
  mutate(percentage=n/sum)
education_df</code></pre>
<pre><code>## # A tibble: 27 × 5
## # Groups:   education [9]
##    smoke          education                            n   sum percentage
##    &lt;chr&gt;          &lt;chr&gt;                            &lt;int&gt; &lt;int&gt;      &lt;dbl&gt;
##  1 current smoker 12th grade, no diploma             186   876     0.212 
##  2 current smoker associate degree: academic         725  5709     0.127 
##  3 current smoker bachelor&#39;s degree                  939 14093     0.0666
##  4 current smoker doctoral degree                     50  1359     0.0368
##  5 current smoker GED or equivalent                  469  1405     0.334 
##  6 current smoker grade 1-11                         908  4222     0.215 
##  7 current smoker high school graduate              2397 13888     0.173 
##  8 current smoker never attended/kindergarten only    13   145     0.0897
##  9 current smoker some college, no degree           1479  9977     0.148 
## 10 former smoker  12th grade, no diploma             187   876     0.213 
## # … with 17 more rows</code></pre>
<pre class="r"><code>ggplot(education_df,aes(fill=smoke,x=education,y=percentage))+
  geom_bar(position=&quot;stack&quot;, stat=&quot;identity&quot;)+
  labs(
    title=&quot;smokers by education&quot;,
    x=&quot;education&quot;,
    y=&quot;value&quot;
  )+
  theme(axis.text.x=element_text(angle=45))</code></pre>
<p><img src="smoking_and_covid19_files/figure-html/unnamed-chunk-1-2.png" width="90%" /></p>
<pre class="r"><code>age_df=
  adult%&gt;%
  mutate(age=ifelse(age&lt;=18,&quot;0-18 years old&quot;,ifelse(age&lt;=21,&quot;18-21 years old&quot;,ifelse(age&lt;=65,&quot;21-65 years old&quot;,&quot;above 65 years old&quot;))))%&gt;%
  group_by(smoke,age)%&gt;%
  summarise(n=n())%&gt;%
  group_by(age)%&gt;%
  mutate(sum=sum(n))%&gt;%
  mutate(percentage=n/sum)
age_df</code></pre>
<pre><code>## # A tibble: 12 × 5
## # Groups:   age [4]
##    smoke          age                    n   sum percentage
##    &lt;chr&gt;          &lt;chr&gt;              &lt;int&gt; &lt;int&gt;      &lt;dbl&gt;
##  1 current smoker 0-18 years old        16   414     0.0386
##  2 current smoker 18-21 years old       98  1484     0.0660
##  3 current smoker 21-65 years old     6422 42476     0.151 
##  4 current smoker above 65 years old  1373 17805     0.0771
##  5 former smoker  0-18 years old         5   414     0.0121
##  6 former smoker  18-21 years old       54  1484     0.0364
##  7 former smoker  21-65 years old     9042 42476     0.213 
##  8 former smoker  above 65 years old  7014 17805     0.394 
##  9 never smoker   0-18 years old       393   414     0.949 
## 10 never smoker   18-21 years old     1332  1484     0.898 
## 11 never smoker   21-65 years old    27012 42476     0.636 
## 12 never smoker   above 65 years old  9418 17805     0.529</code></pre>
<pre class="r"><code>ggplot(age_df,aes(fill=smoke,x=age,y=percentage))+
  geom_bar(position=&quot;stack&quot;, stat=&quot;identity&quot;)+
  labs(
    title=&quot;smokers by age&quot;,
    x=&quot;age&quot;,
    y=&quot;value&quot;
  )+
  theme(axis.text.x=element_text(angle=45))</code></pre>
<p><img src="smoking_and_covid19_files/figure-html/unnamed-chunk-1-3.png" width="90%" /></p>
<pre class="r"><code>health_status_df=
  adult%&gt;%
  filter(health%in%c(&quot;excellent&quot;,&quot;vert good&quot;,&quot;good&quot;,&quot;fair&quot;,&quot;poor&quot;))%&gt;%
  group_by(smoke,health)%&gt;%
  summarise(n=n())%&gt;%
  group_by(health)%&gt;%
  mutate(sum=sum(n))%&gt;%
  mutate(percentage=n/sum)

ggplot(health_status_df,aes(fill=smoke,x=health,y=percentage))+
  geom_bar(position=&quot;stack&quot;, stat=&quot;identity&quot;)+
  labs(
    title=&quot;smokers by health&quot;,
    x=&quot;health&quot;,
    y=&quot;value&quot;
  )+
  theme(axis.text.x=element_text(angle=45))</code></pre>
<p><img src="smoking_and_covid19_files/figure-html/unnamed-chunk-1-4.png" width="90%" /></p>
<pre class="r"><code>race_df=
  adult%&gt;%
  group_by(smoke,race)%&gt;%
  summarise(n=n())%&gt;%
  group_by(race)%&gt;%
  mutate(sum=sum(n))%&gt;%
  mutate(percentage=n/sum)

ggplot(race_df,aes(fill=smoke,x=race,y=percentage))+
  geom_bar(position=&quot;stack&quot;, stat=&quot;identity&quot;)+
  labs(
    title=&quot;smokers by race&quot;,
    x=&quot;race&quot;,
    y=&quot;value&quot;
  )+
  theme(axis.text.x=element_text(angle=45))</code></pre>
<p><img src="smoking_and_covid19_files/figure-html/unnamed-chunk-1-5.png" width="90%" /></p>
<pre class="r"><code>disability_df=
  adult%&gt;%
  filter(disability!=&quot;don&#39;t know&quot;)%&gt;%
  group_by(smoke,disability)%&gt;%
  summarise(n=n())%&gt;%
  group_by(disability)%&gt;%
  mutate(sum=sum(n))%&gt;%
  mutate(percentage=n/sum)
  
ggplot(disability_df,aes(fill=smoke,x=disability,y=percentage))+
  geom_bar(position=&quot;stack&quot;, stat=&quot;identity&quot;)+
  labs(
    title=&quot;smokers by disability&quot;,
    x=&quot;disability&quot;,
    y=&quot;value&quot;
  )+
  theme(axis.text.x=element_text(angle=45))</code></pre>
<p><img src="smoking_and_covid19_files/figure-html/unnamed-chunk-1-6.png" width="90%" /></p>
<pre class="r"><code>orient_df=
  adult%&gt;%
  filter(!orient%in%c(&quot;not ascertained&quot;,&quot;refused&quot;,&quot;unknown&quot;))%&gt;%
  group_by(smoke,orient)%&gt;%
  summarise(n=n())%&gt;%
  group_by(orient)%&gt;%
  mutate(sum=sum(n))%&gt;%
  mutate(percentage=n/sum)
  
ggplot(orient_df,aes(fill=smoke,x=orient,y=percentage))+
  geom_bar(position=&quot;stack&quot;, stat=&quot;identity&quot;)+
  labs(
    title=&quot;smokers by orient&quot;,
    x=&quot;orient&quot;,
    y=&quot;value&quot;
  )+
  theme(axis.text.x=element_text(angle=45))</code></pre>
<p><img src="smoking_and_covid19_files/figure-html/unnamed-chunk-1-7.png" width="90%" /></p>
<pre class="r"><code>immune_weaken_df=
  adult%&gt;%
  filter(!immune_weaken%in%c(&quot;not ascertained&quot;,&quot;refused&quot;,&quot;don&#39;t know&quot;,&quot;missing&quot;))%&gt;%
  group_by(smoke,immune_weaken)%&gt;%
  summarise(n=n())%&gt;%
  group_by(immune_weaken)%&gt;%
  mutate(sum=sum(n))%&gt;%
  mutate(percentage=n/sum)
  
ggplot(immune_weaken_df,aes(fill=smoke,x=immune_weaken,y=percentage))+
  geom_bar(position=&quot;stack&quot;, stat=&quot;identity&quot;)+
  labs(
    title=&quot;smokers by immune weaken&quot;,
    x=&quot;immune weaken&quot;,
    y=&quot;value&quot;
  )+
  theme(axis.text.x=element_text(angle=45))</code></pre>
<p><img src="smoking_and_covid19_files/figure-html/unnamed-chunk-1-8.png" width="90%" /></p>
<pre class="r"><code>#Cancer
cancer_df=
  adult%&gt;%
  group_by(year,smoke,cancer)%&gt;%
  filter(!cancer%in%c(&quot;don&#39;t know&quot;,&quot;refused&quot;))%&gt;%
  summarise(n=n())%&gt;%
  mutate(cancer_year=str_c(cancer,year))%&gt;%
  group_by(cancer_year)%&gt;%
  mutate(sum=sum(n))%&gt;%
  mutate(percentage=n/sum)
cancer_df</code></pre>
<pre><code>## # A tibble: 12 × 7
## # Groups:   cancer_year [4]
##     year smoke          cancer     n cancer_year   sum percentage
##    &lt;dbl&gt; &lt;chr&gt;          &lt;chr&gt;  &lt;int&gt; &lt;chr&gt;       &lt;int&gt;      &lt;dbl&gt;
##  1  2019 current smoker no      3852 no2019      27405     0.141 
##  2  2019 current smoker yes      438 yes2019      3765     0.116 
##  3  2019 former smoker  no      6578 no2019      27405     0.240 
##  4  2019 former smoker  yes     1390 yes2019      3765     0.369 
##  5  2019 never smoker   no     16975 no2019      27405     0.619 
##  6  2019 never smoker   yes     1937 yes2019      3765     0.514 
##  7  2020 current smoker no      3229 no2020      26899     0.120 
##  8  2020 current smoker yes      380 yes2020      4051     0.0938
##  9  2020 former smoker  no      6590 no2020      26899     0.245 
## 10  2020 former smoker  yes     1543 yes2020      4051     0.381 
## 11  2020 never smoker   no     17080 no2020      26899     0.635 
## 12  2020 never smoker   yes     2128 yes2020      4051     0.525</code></pre>
<pre class="r"><code>ggplot(cancer_df,aes(fill=smoke,x=cancer_year,y=percentage))+
  geom_bar(position=&quot;stack&quot;, stat=&quot;identity&quot;)+
  labs(
    title=&quot;smokers by cancer in 2019 and 2020&quot;,
    x=&quot;cancer&quot;,
    y=&quot;value&quot;
  )+
  theme(axis.text.x=element_text(angle=45))</code></pre>
<p><img src="smoking_and_covid19_files/figure-html/unnamed-chunk-2-1.png" width="90%" /></p>
<pre class="r"><code>#Diabetes type
diabetes_df=
  adult%&gt;%
  mutate(diabetes_type=recode(diabetes_type,&quot;type 1&quot;=&quot;diabetes&quot;,&quot;type 2&quot;=&quot;diabetes&quot;))%&gt;%
  group_by(year,smoke,diabetes_type)%&gt;%
  filter(!diabetes_type%in%c(&quot;don&#39;t know&quot;,&quot;refused&quot;,&quot;missing&quot;))%&gt;%
  summarise(n=n())%&gt;%
  mutate(diabetes_year=str_c(diabetes_type,year))%&gt;%
  group_by(diabetes_year)%&gt;%
  mutate(sum=sum(n))%&gt;%
  mutate(percentage=n/sum)
diabetes_df</code></pre>
<pre><code>## # A tibble: 12 × 7
## # Groups:   diabetes_year [4]
##     year smoke          diabetes_type     n diabetes_year   sum percentage
##    &lt;dbl&gt; &lt;chr&gt;          &lt;chr&gt;         &lt;int&gt; &lt;chr&gt;         &lt;int&gt;      &lt;dbl&gt;
##  1  2019 current smoker diabetes        366 diabetes2019   2995     0.122 
##  2  2019 current smoker other            20 other2019        92     0.217 
##  3  2019 former smoker  diabetes       1048 diabetes2019   2995     0.350 
##  4  2019 former smoker  other            28 other2019        92     0.304 
##  5  2019 never smoker   diabetes       1581 diabetes2019   2995     0.528 
##  6  2019 never smoker   other            44 other2019        92     0.478 
##  7  2020 current smoker diabetes        356 diabetes2020   3021     0.118 
##  8  2020 current smoker other             7 other2020        83     0.0843
##  9  2020 former smoker  diabetes       1046 diabetes2020   3021     0.346 
## 10  2020 former smoker  other            28 other2020        83     0.337 
## 11  2020 never smoker   diabetes       1619 diabetes2020   3021     0.536 
## 12  2020 never smoker   other            48 other2020        83     0.578</code></pre>
<pre class="r"><code>ggplot(diabetes_df,aes(fill=smoke,x=diabetes_year,y=percentage))+
  geom_bar(position=&quot;stack&quot;, stat=&quot;identity&quot;)+
  labs(
    title=&quot;smokers by diabetes in 2019 and 2020&quot;,
    x=&quot;diabetes&quot;,
    y=&quot;value&quot;
  )+
  theme(axis.text.x=element_text(angle=45))</code></pre>
<p><img src="smoking_and_covid19_files/figure-html/unnamed-chunk-2-2.png" width="90%" /></p>
<pre class="r"><code>#COP
cop_df=
  adult%&gt;%
  group_by(year,smoke,copd)%&gt;%
  filter(!copd%in%c(&quot;don&#39;t know&quot;,&quot;refused&quot;,&quot;missing&quot;))%&gt;%
  summarise(n=n())%&gt;%
  mutate(copd_year=str_c(copd,year))%&gt;%
  group_by(copd_year)%&gt;%
  mutate(sum=sum(n))%&gt;%
  mutate(percentage=n/sum)
cop_df</code></pre>
<pre><code>## # A tibble: 12 × 7
## # Groups:   copd_year [4]
##     year smoke          copd      n copd_year   sum percentage
##    &lt;dbl&gt; &lt;chr&gt;          &lt;chr&gt; &lt;int&gt; &lt;chr&gt;     &lt;int&gt;      &lt;dbl&gt;
##  1  2019 current smoker no     3716 no2019    29431      0.126
##  2  2019 current smoker yes     578 yes2019    1737      0.333
##  3  2019 former smoker  no     7176 no2019    29431      0.244
##  4  2019 former smoker  yes     788 yes2019    1737      0.454
##  5  2019 never smoker   no    18539 no2019    29431      0.630
##  6  2019 never smoker   yes     371 yes2019    1737      0.214
##  7  2020 current smoker no     3074 no2020    29131      0.106
##  8  2020 current smoker yes     530 yes2020    1821      0.291
##  9  2020 former smoker  no     7280 no2020    29131      0.250
## 10  2020 former smoker  yes     853 yes2020    1821      0.468
## 11  2020 never smoker   no    18777 no2020    29131      0.645
## 12  2020 never smoker   yes     438 yes2020    1821      0.241</code></pre>
<pre class="r"><code>ggplot(cop_df,aes(fill=smoke,x=copd_year,y=percentage))+
  geom_bar(position=&quot;stack&quot;, stat=&quot;identity&quot;)+
  labs(
    title=&quot;smokers by COPD in 2019 and 2020&quot;,
    x=&quot;COPD&quot;,
    y=&quot;value&quot;
  )+
  theme(axis.text.x=element_text(angle=45))</code></pre>
<p><img src="smoking_and_covid19_files/figure-html/unnamed-chunk-3-1.png" width="90%" /></p>
<pre class="r"><code>hypev_df=
  adult%&gt;%
  group_by(year,smoke,hypertention)%&gt;%
  filter(!hypertention%in%c(&quot;don&#39;t know&quot;,&quot;refused&quot;,&quot;missing&quot;))%&gt;%
  summarise(n=n())%&gt;%
  mutate(hypertention_year=str_c(hypertention,year))%&gt;%
  group_by(hypertention_year)%&gt;%
  mutate(sum=sum(n))%&gt;%
  mutate(percentage=n/sum)
hypev_df</code></pre>
<pre><code>## # A tibble: 12 × 7
## # Groups:   hypertention_year [4]
##     year smoke          hypertention     n hypertention_year   sum percentage
##    &lt;dbl&gt; &lt;chr&gt;          &lt;chr&gt;        &lt;int&gt; &lt;chr&gt;             &lt;int&gt;      &lt;dbl&gt;
##  1  2019 current smoker no            2697 no2019            19964      0.135
##  2  2019 current smoker yes           1598 yes2019           11191      0.143
##  3  2019 former smoker  no            4266 no2019            19964      0.214
##  4  2019 former smoker  yes           3695 yes2019           11191      0.330
##  5  2019 never smoker   no           13001 no2019            19964      0.651
##  6  2019 never smoker   yes           5898 yes2019           11191      0.527
##  7  2020 current smoker no            2193 no2020            19673      0.111
##  8  2020 current smoker yes           1413 yes2020           11265      0.125
##  9  2020 former smoker  no            4336 no2020            19673      0.220
## 10  2020 former smoker  yes           3800 yes2020           11265      0.337
## 11  2020 never smoker   no           13144 no2020            19673      0.668
## 12  2020 never smoker   yes           6052 yes2020           11265      0.537</code></pre>
<pre class="r"><code>ggplot(hypev_df,aes(fill=smoke,x=hypertention_year,y=percentage))+
  geom_bar(position=&quot;stack&quot;, stat=&quot;identity&quot;)+
  labs(
    title=&quot;smokers by hypertention in 2019 and 2020&quot;,
    x=&quot;hypertention&quot;,
    y=&quot;value&quot;
  )+
  theme(axis.text.x=element_text(angle=45))</code></pre>
<p><img src="smoking_and_covid19_files/figure-html/unnamed-chunk-3-2.png" width="90%" /></p>
<pre class="r"><code>#Stroke
stroke_df=
  adult%&gt;%
  group_by(year,smoke,stroke)%&gt;%
  filter(!stroke%in%c(&quot;don&#39;t know&quot;,&quot;refused&quot;,&quot;missing&quot;))%&gt;%
  summarise(n=n())%&gt;%
  mutate(stroke_year=str_c(stroke,year))%&gt;%
  group_by(stroke_year)%&gt;%
  mutate(sum=sum(n))%&gt;%
  mutate(percentage=n/sum)
stroke_df</code></pre>
<pre><code>## # A tibble: 12 × 7
## # Groups:   stroke_year [4]
##     year smoke          stroke     n stroke_year   sum percentage
##    &lt;dbl&gt; &lt;chr&gt;          &lt;chr&gt;  &lt;int&gt; &lt;chr&gt;       &lt;int&gt;      &lt;dbl&gt;
##  1  2019 current smoker no      4084 no2019      30001      0.136
##  2  2019 current smoker yes      209 yes2019      1167      0.179
##  3  2019 former smoker  no      7516 no2019      30001      0.251
##  4  2019 former smoker  yes      450 yes2019      1167      0.386
##  5  2019 never smoker   no     18401 no2019      30001      0.613
##  6  2019 never smoker   yes      508 yes2019      1167      0.435
##  7  2020 current smoker no      3428 no2020      29917      0.115
##  8  2020 current smoker yes      177 yes2020      1036      0.171
##  9  2020 former smoker  no      7745 no2020      29917      0.259
## 10  2020 former smoker  yes      389 yes2020      1036      0.375
## 11  2020 never smoker   no     18744 no2020      29917      0.627
## 12  2020 never smoker   yes      470 yes2020      1036      0.454</code></pre>
<pre class="r"><code>ggplot(stroke_df,aes(fill=smoke,x=stroke_year,y=percentage))+
  geom_bar(position=&quot;stack&quot;, stat=&quot;identity&quot;)+
  labs(
    title=&quot;smokers by stroke in 2019 and 2020&quot;,
    x=&quot;stroke&quot;,
    y=&quot;value&quot;
  )+
  theme(axis.text.x=element_text(angle=45))</code></pre>
<p><img src="smoking_and_covid19_files/figure-html/unnamed-chunk-4-1.png" width="90%" /></p>
<pre class="r"><code>#Asthma
asthma_df=
  adult%&gt;%
  group_by(year,smoke,asthma)%&gt;%
  filter(!asthma%in%c(&quot;don&#39;t know&quot;,&quot;refused&quot;,&quot;missing&quot;))%&gt;%
  summarise(n=n())%&gt;%
  mutate(asthma_year=str_c(asthma,year))%&gt;%
  group_by(asthma_year)%&gt;%
  mutate(sum=sum(n))%&gt;%
  mutate(percentage=n/sum)
asthma_df</code></pre>
<pre><code>## # A tibble: 12 × 7
## # Groups:   asthma_year [4]
##     year smoke          asthma     n asthma_year   sum percentage
##    &lt;dbl&gt; &lt;chr&gt;          &lt;chr&gt;  &lt;int&gt; &lt;chr&gt;       &lt;int&gt;      &lt;dbl&gt;
##  1  2019 current smoker no       218 no2019       1590      0.137
##  2  2019 current smoker yes      468 yes2019      2528      0.185
##  3  2019 former smoker  no       420 no2019       1590      0.264
##  4  2019 former smoker  yes      665 yes2019      2528      0.263
##  5  2019 never smoker   no       952 no2019       1590      0.599
##  6  2019 never smoker   yes     1395 yes2019      2528      0.552
##  7  2020 current smoker no       211 no2020       1674      0.126
##  8  2020 current smoker yes      340 yes2020      2550      0.133
##  9  2020 former smoker  no       420 no2020       1674      0.251
## 10  2020 former smoker  yes      701 yes2020      2550      0.275
## 11  2020 never smoker   no      1043 no2020       1674      0.623
## 12  2020 never smoker   yes     1509 yes2020      2550      0.592</code></pre>
<pre class="r"><code>ggplot(asthma_df,aes(fill=smoke,x=asthma_year,y=percentage))+
  geom_bar(position=&quot;stack&quot;, stat=&quot;identity&quot;)+
  labs(
    title=&quot;smokers by asthma in 2019 and 2020&quot;,
    x=&quot;asthma&quot;,
    y=&quot;value&quot;
  )+
  theme(axis.text.x=element_text(angle=45))</code></pre>
<p><img src="smoking_and_covid19_files/figure-html/unnamed-chunk-4-2.png" width="90%" /></p>
<pre class="r"><code>#Dementia
dementia_df=
  adult%&gt;%
  group_by(year,smoke,dementia)%&gt;%
  filter(!dementia%in%c(&quot;don&#39;t know&quot;,&quot;refused&quot;,&quot;missing&quot;))%&gt;%
  summarise(n=n())%&gt;%
  mutate(dementia_year=str_c(dementia,year))%&gt;%
  group_by(dementia_year)%&gt;%
  mutate(sum=sum(n))%&gt;%
  mutate(percentage=n/sum)
dementia_df</code></pre>
<pre><code>## # A tibble: 12 × 7
## # Groups:   dementia_year [4]
##     year smoke          dementia     n dementia_year   sum percentage
##    &lt;dbl&gt; &lt;chr&gt;          &lt;chr&gt;    &lt;int&gt; &lt;chr&gt;         &lt;int&gt;      &lt;dbl&gt;
##  1  2019 current smoker no        4261 no2019        30843     0.138 
##  2  2019 current smoker yes         29 yes2019         330     0.0879
##  3  2019 former smoker  no        7844 no2019        30843     0.254 
##  4  2019 former smoker  yes        124 yes2019         330     0.376 
##  5  2019 never smoker   no       18738 no2019        30843     0.608 
##  6  2019 never smoker   yes        177 yes2019         330     0.536 
##  7  2020 current smoker no        3578 no2020        30663     0.117 
##  8  2020 current smoker yes         32 yes2020         301     0.106 
##  9  2020 former smoker  no        8034 no2020        30663     0.262 
## 10  2020 former smoker  yes        102 yes2020         301     0.339 
## 11  2020 never smoker   no       19051 no2020        30663     0.621 
## 12  2020 never smoker   yes        167 yes2020         301     0.555</code></pre>
<pre class="r"><code>ggplot(dementia_df,aes(fill=smoke,x=dementia_year,y=percentage))+
  geom_bar(position=&quot;stack&quot;, stat=&quot;identity&quot;)+
  labs(
    title=&quot;smokers by dementia in 2019 and 2020&quot;,
    x=&quot;dementia&quot;,
    y=&quot;value&quot;
  )+
  theme(axis.text.x=element_text(angle=45))</code></pre>
<p><img src="smoking_and_covid19_files/figure-html/unnamed-chunk-4-3.png" width="90%" /></p>
<pre class="r"><code># Heart Disease
heart_disease_df=
  adult%&gt;%
  group_by(year,smoke,heart_disease)%&gt;%
  filter(!heart_disease%in%c(&quot;don&#39;t know&quot;,&quot;refused&quot;,&quot;missing&quot;))%&gt;%
  summarise(n=n())%&gt;%
  mutate(heart_disease_year=str_c(heart_disease,year))%&gt;%
  group_by(heart_disease_year)%&gt;%
  mutate(sum=sum(n))%&gt;%
  mutate(percentage=n/sum)
heart_disease_df</code></pre>
<pre><code>## # A tibble: 12 × 7
## # Groups:   heart_disease_year [4]
##     year smoke          heart_disease     n heart_disease_year   sum percentage
##    &lt;dbl&gt; &lt;chr&gt;          &lt;chr&gt;         &lt;int&gt; &lt;chr&gt;              &lt;int&gt;      &lt;dbl&gt;
##  1  2019 current smoker no             4060 no2019             29314      0.139
##  2  2019 current smoker yes             226 yes2019             1802      0.125
##  3  2019 former smoker  no             7128 no2019             29314      0.243
##  4  2019 former smoker  yes             818 yes2019             1802      0.454
##  5  2019 never smoker   no            18126 no2019             29314      0.618
##  6  2019 never smoker   yes             758 yes2019             1802      0.421
##  7  2020 current smoker no             3408 no2020             29050      0.117
##  8  2020 current smoker yes             190 yes2020             1859      0.102
##  9  2020 former smoker  no             7242 no2020             29050      0.249
## 10  2020 former smoker  yes             878 yes2020             1859      0.472
## 11  2020 never smoker   no            18400 no2020             29050      0.633
## 12  2020 never smoker   yes             791 yes2020             1859      0.425</code></pre>
<pre class="r"><code>ggplot(heart_disease_df,aes(fill=smoke,x=heart_disease_year,y=percentage))+
  geom_bar(position=&quot;stack&quot;, stat=&quot;identity&quot;)+
  labs(
    title=&quot;smokers by heart disease in 2019 and 2020&quot;,
    x=&quot;heart disease&quot;,
    y=&quot;value&quot;
  )+
  theme(axis.text.x=element_text(angle=45))</code></pre>
<p><img src="smoking_and_covid19_files/figure-html/unnamed-chunk-4-4.png" width="90%" /></p>
<pre class="r"><code>#Anxiety
anxiety_df=
  adult%&gt;%
  group_by(year,smoke,anxiety)%&gt;%
  filter(!anxiety%in%c(&quot;don&#39;t know&quot;,&quot;refused&quot;,&quot;missing&quot;))%&gt;%
  summarise(n=n())%&gt;%
  mutate(anxiety_year=str_c(anxiety,year))%&gt;%
  group_by(anxiety_year)%&gt;%
  mutate(sum=sum(n))%&gt;%
  mutate(percentage=n/sum)
anxiety_df</code></pre>
<pre><code>## # A tibble: 12 × 7
## # Groups:   anxiety_year [4]
##     year smoke          anxiety     n anxiety_year   sum percentage
##    &lt;dbl&gt; &lt;chr&gt;          &lt;chr&gt;   &lt;int&gt; &lt;chr&gt;        &lt;int&gt;      &lt;dbl&gt;
##  1  2019 current smoker no       3232 no2019       26531      0.122
##  2  2019 current smoker yes      1059 yes2019       4627      0.229
##  3  2019 former smoker  no       6616 no2019       26531      0.249
##  4  2019 former smoker  yes      1343 yes2019       4627      0.290
##  5  2019 never smoker   no      16683 no2019       26531      0.629
##  6  2019 never smoker   yes      2225 yes2019       4627      0.481
##  7  2020 current smoker no       2700 no2020       26126      0.103
##  8  2020 current smoker yes       903 yes2020       4808      0.188
##  9  2020 former smoker  no       6750 no2020       26126      0.258
## 10  2020 former smoker  yes      1381 yes2020       4808      0.287
## 11  2020 never smoker   no      16676 no2020       26126      0.638
## 12  2020 never smoker   yes      2524 yes2020       4808      0.525</code></pre>
<pre class="r"><code>ggplot(anxiety_df,aes(fill=smoke,x=anxiety,y=percentage))+
  geom_bar(position=&quot;stack&quot;, stat=&quot;identity&quot;)+
  labs(
    title=&quot;smokers by anxiety in 2019 and 2020&quot;,
    x=&quot;anxiety&quot;,
    y=&quot;value&quot;
  )+
  theme(axis.text.x=element_text(angle=45))</code></pre>
<p><img src="smoking_and_covid19_files/figure-html/unnamed-chunk-5-1.png" width="90%" /></p>
<pre class="r"><code>#Depression
depression_df=
  adult%&gt;%
  group_by(year,smoke,depression)%&gt;%
  filter(!depression%in%c(&quot;don&#39;t know&quot;,&quot;refused&quot;,&quot;missing&quot;))%&gt;%
  summarise(n=n())%&gt;%
  mutate(depression_year=str_c(depression,year))%&gt;%
  group_by(depression_year)%&gt;%
  mutate(sum=sum(n))%&gt;%
  mutate(percentage=n/sum)
depression_df</code></pre>
<pre><code>## # A tibble: 12 × 7
## # Groups:   depression_year [4]
##     year smoke          depression     n depression_year   sum percentage
##    &lt;dbl&gt; &lt;chr&gt;          &lt;chr&gt;      &lt;int&gt; &lt;chr&gt;           &lt;int&gt;      &lt;dbl&gt;
##  1  2019 current smoker no          3103 no2019          25832      0.120
##  2  2019 current smoker yes         1189 yes2019          5322      0.223
##  3  2019 former smoker  no          6392 no2019          25832      0.247
##  4  2019 former smoker  yes         1568 yes2019          5322      0.295
##  5  2019 never smoker   no         16337 no2019          25832      0.632
##  6  2019 never smoker   yes         2565 yes2019          5322      0.482
##  7  2020 current smoker no          2603 no2020          25506      0.102
##  8  2020 current smoker yes         1001 yes2020          5425      0.185
##  9  2020 former smoker  no          6530 no2020          25506      0.256
## 10  2020 former smoker  yes         1598 yes2020          5425      0.295
## 11  2020 never smoker   no         16373 no2020          25506      0.642
## 12  2020 never smoker   yes         2826 yes2020          5425      0.521</code></pre>
<pre class="r"><code>ggplot(depression_df,aes(fill=smoke,x=depression_year,y=percentage))+
  geom_bar(position=&quot;stack&quot;, stat=&quot;identity&quot;)+
  labs(
    title=&quot;smokers by depression in 2019 and 2020&quot;,
    x=&quot;depression&quot;,
    y=&quot;value&quot;
  )+
  theme(axis.text.x=element_text(angle=45))</code></pre>
<p><img src="smoking_and_covid19_files/figure-html/unnamed-chunk-5-2.png" width="90%" /></p>
<pre class="r"><code>#Bmi
bmi_df=
  adult%&gt;%
  group_by(year,smoke,bmi)%&gt;%
  filter(!bmi%in%c(&quot;don&#39;t know&quot;,&quot;refused&quot;,&quot;missing&quot;,&quot;unknown&quot;))%&gt;%
  summarise(n=n())%&gt;%
  mutate(bmi_year=str_c(bmi,year))%&gt;%
  group_by(bmi_year)%&gt;%
  mutate(sum=sum(n))%&gt;%
  mutate(percentage=n/sum)
bmi_df</code></pre>
<pre><code>## # A tibble: 24 × 7
## # Groups:   bmi_year [8]
##     year smoke          bmi                n bmi_year             sum percentage
##    &lt;dbl&gt; &lt;chr&gt;          &lt;chr&gt;          &lt;int&gt; &lt;chr&gt;              &lt;int&gt;      &lt;dbl&gt;
##  1  2019 current smoker healthy weight  1459 healthy weight2019  9722      0.150
##  2  2019 current smoker obese           1278 obese2019           9776      0.131
##  3  2019 current smoker overweight      1370 overweight2019     10418      0.132
##  4  2019 current smoker underweight       95 underweight2019      498      0.191
##  5  2019 former smoker  healthy weight  2114 healthy weight2019  9722      0.217
##  6  2019 former smoker  obese           2735 obese2019           9776      0.280
##  7  2019 former smoker  overweight      2847 overweight2019     10418      0.273
##  8  2019 former smoker  underweight       92 underweight2019      498      0.185
##  9  2019 never smoker   healthy weight  6149 healthy weight2019  9722      0.632
## 10  2019 never smoker   obese           5763 obese2019           9776      0.590
## # … with 14 more rows</code></pre>
<pre class="r"><code>ggplot(bmi_df,aes(fill=smoke,x=bmi_year,y=percentage))+
  geom_bar(position=&quot;stack&quot;, stat=&quot;identity&quot;)+
  labs(
    title=&quot;smokers by bmi in 2019 and 2020&quot;,
    x=&quot;bmi&quot;,
    y=&quot;value&quot;
  )+
  theme(axis.text.x=element_text(angle=45))</code></pre>
<p><img src="smoking_and_covid19_files/figure-html/unnamed-chunk-6-1.png" width="90%" /></p>
<pre class="r"><code>#Pregnant
pregnant_df=
  adult%&gt;%
  group_by(year,smoke,pregnant)%&gt;%
  filter(!pregnant%in%c(&quot;don&#39;t know&quot;,&quot;refused&quot;,&quot;missing&quot;,&quot;unknown&quot;))%&gt;%
  summarise(n=n())%&gt;%
  mutate(pregnant_year=str_c(pregnant,year))%&gt;%
  group_by(pregnant_year)%&gt;%
  mutate(sum=sum(n))%&gt;%
  mutate(percentage=n/sum)
pregnant_df</code></pre>
<pre><code>## # A tibble: 15 × 7
## # Groups:   pregnant_year [5]
##     year smoke          pregnant            n pregnant_year       sum percentage
##    &lt;dbl&gt; &lt;chr&gt;          &lt;chr&gt;           &lt;int&gt; &lt;chr&gt;             &lt;int&gt;      &lt;dbl&gt;
##  1  2019 current smoker no                988 no2019             7138     0.138 
##  2  2019 current smoker yes                13 yes2019             222     0.0586
##  3  2019 former smoker  no                934 no2019             7138     0.131 
##  4  2019 former smoker  yes                40 yes2019             222     0.180 
##  5  2019 never smoker   no               5216 no2019             7138     0.731 
##  6  2019 never smoker   yes               169 yes2019             222     0.761 
##  7  2020 current smoker no                699 no2020             6517     0.107 
##  8  2020 current smoker not ascertained     3 not ascertained2…    23     0.130 
##  9  2020 current smoker yes                12 yes2020             175     0.0686
## 10  2020 former smoker  no                920 no2020             6517     0.141 
## 11  2020 former smoker  not ascertained     3 not ascertained2…    23     0.130 
## 12  2020 former smoker  yes                28 yes2020             175     0.16  
## 13  2020 never smoker   no               4898 no2020             6517     0.752 
## 14  2020 never smoker   not ascertained    17 not ascertained2…    23     0.739 
## 15  2020 never smoker   yes               135 yes2020             175     0.771</code></pre>
<pre class="r"><code>ggplot(pregnant_df,aes(fill=smoke,x=pregnant_year,y=percentage))+
  geom_bar(position=&quot;stack&quot;, stat=&quot;identity&quot;)+
  labs(
    title=&quot;smokers by pregnant in 2019 and 2020&quot;,
    x=&quot;pregnant&quot;,
    y=&quot;value&quot;
  )+
  theme(axis.text.x=element_text(angle=45))</code></pre>
<p><img src="smoking_and_covid19_files/figure-html/unnamed-chunk-6-2.png" width="90%" /></p>
</div>




</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
