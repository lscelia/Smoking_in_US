<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="Wanxin Qi" />


<title>Smoking and Covid-19</title>

<script src="site_libs/header-attrs-2.10/header-attrs.js"></script>
<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/cosmo.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet" />
<link href="site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet" />

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>








<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.tab('show');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->




</head>

<body>


<div class="container-fluid main-container">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Home</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="about.html">About</a>
</li>
<li>
  <a href="mailto:##Email">
    <span class="fa fa-envelope fa-lg"></span>
     
  </a>
</li>
<li>
  <a>
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">



<h1 class="title toc-ignore">Smoking and Covid-19</h1>
<h4 class="author">Wanxin Qi</h4>
<h4 class="date">12/7/2021</h4>

</div>


<div id="import-and-clean-data-from-nhis" class="section level2">
<h2>Import and Clean Data From NHIS</h2>
<pre class="r"><code>adult_19 = 
  read_csv(&quot;data/adult19.csv&quot;) %&gt;%
  select(SEX_A, AGEP_A, SMKCIGST_A, PHSTAT_A, EDUC_A, ORIENT_A, HISPALLP_A, HISDETP_A, DISAB3_A, BMICAT_A, CANEV_A, DIBEV_A, DIBTYPE_A, DEMENEV_A, CHDEV_A, PREGNOW_A, ASTILL_A, STREV_A, HYPEV_A, COPDEV_A, ANXEV_A, DEPEV_A) %&gt;%
  mutate(YEAR = 2019,
         HLTHCOND_A = NA
         ) %&gt;%
  relocate(YEAR)

adult_20 = 
  read_csv(&quot;data/adult20.csv&quot;) %&gt;%
  select(SEX_A, AGEP_A, SMKCIGST_A, PHSTAT_A, EDUC_A, ORIENT_A, HISPALLP_A, HISDETP_A, DISAB3_A, BMICAT_A, CANEV_A, DIBEV_A, DIBTYPE_A, DEMENEV_A, CHDEV_A, PREGNOW_A, ASTILL_A, STREV_A, HYPEV_A, COPDEV_A, ANXEV_A, DEPEV_A, HLTHCOND_A) %&gt;%
  mutate(YEAR = 2020) %&gt;%
  relocate(YEAR)

adult = rbind(adult_19, adult_20)</code></pre>
<pre class="r"><code>adult =
  adult %&gt;%
  janitor::clean_names() %&gt;%
  mutate(
    sex = case_when(
      sex_a == &quot;1&quot; ~ &quot;male&quot;,
      sex_a == &quot;2&quot; ~ &quot;female&quot;,
      sex_a == &quot;7&quot; ~ &quot;refused&quot;,
      sex_a == &quot;8&quot; ~ &quot;not ascertained&quot;,
      sex_a == &quot;9&quot; ~ &quot;don&#39;t know&quot;
    ),
    
    age = agep_a,
    
    smoke = case_when(
      smkcigst_a == &quot;1&quot; ~ &quot;current every day smoker&quot;,
      smkcigst_a == &quot;2&quot; ~ &quot;current some day smoker&quot;,
      smkcigst_a == &quot;3&quot; ~ &quot;former smoker&quot;,
      smkcigst_a == &quot;4&quot; ~ &quot;never smoker&quot;,
      smkcigst_a == &quot;5&quot; ~ &quot;smoker, current status unknown&quot;,
      smkcigst_a == &quot;9&quot; ~ &quot;unknown if ever smoked&quot;
    ),

    education = case_when(
      educ_a == &quot;0&quot; ~ &quot;never attended/kindergarten only&quot;,
      educ_a == &quot;1&quot; ~ &quot;grade 1-11&quot;,
      educ_a == &quot;2&quot; ~ &quot;12th grade, no diploma&quot;,
      educ_a == &quot;3&quot; ~ &quot;GED or equivalent&quot;,
      educ_a == &quot;4&quot; ~ &quot;high school graduate&quot;,
      educ_a == &quot;5&quot; ~ &quot;some college, no degree&quot;,
      educ_a == &quot;6&quot; ~ &quot;associate degree: occupational, technical, or vocational program&quot;,
      educ_a == &quot;7&quot; ~ &quot;associate degree: academic&quot;,
      educ_a == &quot;8&quot; ~ &quot;bachelor&#39;s degree&quot;,
      educ_a == &quot;9&quot; ~ &quot;master&#39;s degree&quot;,
      educ_a == &quot;10&quot; ~ &quot;professional school&quot;,
      educ_a == &quot;11&quot; ~ &quot;doctoral degree&quot;,
      educ_a == &quot;97&quot; ~ &quot;refused&quot;,
      educ_a == &quot;98&quot; ~ &quot;not ascertained&quot;,
      educ_a == &quot;99&quot; ~ &quot;don&#39;t know&quot;
    ),
    
    race = case_when(
      hispallp_a == &quot;1&quot; ~ &quot;hispanic&quot;,
      hispallp_a == &quot;2&quot; ~ &quot;white&quot;,
      hispallp_a == &quot;3&quot; ~ &quot;black or african american&quot;,
      hispallp_a == &quot;4&quot; ~ &quot;asian&quot;,
      hispallp_a == &quot;5&quot; ~ &quot;aian&quot;,
      hispallp_a == &quot;6&quot; ~ &quot;aian and other&quot;,
      hispallp_a == &quot;7&quot; ~ &quot;multiple races&quot;,
      hispallp_a == &quot;97&quot; ~ &quot;refused&quot;,
      hispallp_a == &quot;98&quot; ~ &quot;not ascertained&quot;,
      hispallp_a == &quot;99&quot; ~ &quot;don&#39;t know&quot;
    ),
    
    hispanic_origin = case_when(
      hisdetp_a == &quot;1&quot; ~ &quot;mexican&quot;,
      hisdetp_a == &quot;2&quot; ~ &quot;other hispanic&quot;,
      hisdetp_a == &quot;3&quot; ~ &quot;not hispanic&quot;,
      hisdetp_a == &quot;7&quot; ~ &quot;refused&quot;,
      hisdetp_a == &quot;8&quot; ~ &quot;not ascertained&quot;,
      hisdetp_a == &quot;9&quot; ~ &quot;don&#39;t know&quot;
    ),
    
    disability = case_when(
      disab3_a == &quot;1&quot; ~ &quot;yes&quot;,
      disab3_a == &quot;2&quot; ~ &quot;no&quot;,
      disab3_a == &quot;9&quot; ~ &quot;don&#39;t know&quot;
    ),
    
    health = case_when(
      phstat_a == &quot;1&quot; ~ &quot;excellent&quot;,
      phstat_a == &quot;2&quot; ~ &quot;very good&quot;,
      phstat_a == &quot;3&quot; ~ &quot;good&quot;,
      phstat_a == &quot;4&quot; ~ &quot;fair&quot;,
      phstat_a == &quot;5&quot; ~ &quot;poor&quot;,
      phstat_a == &quot;7&quot; ~ &quot;refused&quot;,
      phstat_a == &quot;8&quot; ~ &quot;not ascertained&quot;,
      phstat_a == &quot;9&quot; ~ &quot;don&#39;t know&quot;
    ),
    
    orient = case_when(
      orient_a == &quot;1&quot; ~ &quot;gaylesbian&quot;,
      orient_a == &quot;2&quot; ~ &quot;straight&quot;,
      orient_a == &quot;3&quot; ~ &quot;bisexual&quot;,
      orient_a == &quot;4&quot; ~ &quot;else&quot;,
      orient_a == &quot;5&quot; ~ &quot;unknown&quot;,
      orient_a == &quot;7&quot; ~ &quot;refused&quot;,
      orient_a == &quot;8&quot; ~ &quot;not ascertained&quot;,
      orient_a == &quot;9&quot; ~ &quot;don&#39;t know&quot;
    ),
    
    bmi = case_when(
      bmicat_a == &quot;1&quot; ~ &quot;underweight&quot;,
      bmicat_a == &quot;2&quot; ~ &quot;healthy weight&quot;,
      bmicat_a == &quot;3&quot; ~ &quot;overweight&quot;,
      bmicat_a == &quot;4&quot; ~ &quot;obese&quot;,
      bmicat_a == &quot;9&quot; ~ &quot;unknown&quot;
    ),
    
    cancer = case_when(
      canev_a == &quot;1&quot; ~ &quot;yes&quot;,
      canev_a == &quot;2&quot; ~ &quot;no&quot;,
      canev_a == &quot;7&quot; ~ &quot;refused&quot;,
      canev_a == &quot;8&quot; ~ &quot;not ascertained&quot;,
      canev_a == &quot;9&quot; ~ &quot;don&#39;t know&quot;
    ),

    diabetes_type = case_when(
      dibtype_a == &quot;1&quot; ~ &quot;type 1&quot;,
      dibtype_a == &quot;2&quot; ~ &quot;type 2&quot;,
      dibtype_a == &quot;3&quot; ~ &quot;other&quot;,
      dibtype_a == &quot;7&quot; ~ &quot;refused&quot;,
      dibtype_a == &quot;8&quot; ~ &quot;not ascertained&quot;,
      dibtype_a == &quot;9&quot; ~ &quot;don&#39;t know&quot;
    ),
    
    dementia = case_when(
      demenev_a == &quot;1&quot; ~ &quot;yes&quot;,
      demenev_a == &quot;2&quot; ~ &quot;no&quot;,
      demenev_a == &quot;7&quot; ~ &quot;refused&quot;,
      demenev_a == &quot;8&quot; ~ &quot;not ascertained&quot;,
      demenev_a == &quot;9&quot; ~ &quot;don&#39;t know&quot;
    ),
    
    heart_disease = case_when(
      chdev_a == &quot;1&quot; ~ &quot;yes&quot;,
      chdev_a == &quot;2&quot; ~ &quot;no&quot;,
      chdev_a == &quot;7&quot; ~ &quot;refused&quot;,
      chdev_a == &quot;8&quot; ~ &quot;not ascertained&quot;,
      chdev_a == &quot;9&quot; ~ &quot;don&#39;t know&quot;
    ),
    
    asthma = case_when(
      astill_a == &quot;1&quot; ~ &quot;yes&quot;,
      astill_a == &quot;2&quot; ~ &quot;no&quot;,
      astill_a == &quot;7&quot; ~ &quot;refused&quot;,
      astill_a == &quot;8&quot; ~ &quot;not ascertained&quot;,
      astill_a == &quot;9&quot; ~ &quot;don&#39;t know&quot;
    ),
    
    stroke = case_when(
      strev_a == &quot;1&quot; ~ &quot;yes&quot;,
      strev_a == &quot;2&quot; ~ &quot;no&quot;,
      strev_a == &quot;7&quot; ~ &quot;refused&quot;,
      strev_a == &quot;8&quot; ~ &quot;not ascertained&quot;,
      strev_a == &quot;9&quot; ~ &quot;don&#39;t know&quot;
    ),
    
    hypertention = case_when(
      hypev_a == &quot;1&quot; ~ &quot;yes&quot;,
      hypev_a == &quot;2&quot; ~ &quot;no&quot;,
      hypev_a == &quot;7&quot; ~ &quot;refused&quot;,
      hypev_a == &quot;8&quot; ~ &quot;not ascertained&quot;,
      hypev_a == &quot;9&quot; ~ &quot;don&#39;t know&quot;
    ),
    
    copd = case_when(
      copdev_a == &quot;1&quot; ~ &quot;yes&quot;,
      copdev_a == &quot;2&quot; ~ &quot;no&quot;,
      copdev_a == &quot;7&quot; ~ &quot;refused&quot;,
      copdev_a == &quot;8&quot; ~ &quot;not ascertained&quot;,
      copdev_a == &quot;9&quot; ~ &quot;don&#39;t know&quot;
    ),
    
    anxiety = case_when(
      anxev_a == &quot;1&quot; ~ &quot;yes&quot;,
      anxev_a == &quot;2&quot; ~ &quot;no&quot;,
      anxev_a == &quot;7&quot; ~ &quot;refused&quot;,
      anxev_a == &quot;8&quot; ~ &quot;not ascertained&quot;,
      anxev_a == &quot;9&quot; ~ &quot;don&#39;t know&quot;
    ),
    
    depression = case_when(
      depev_a == &quot;1&quot; ~ &quot;yes&quot;,
      depev_a == &quot;2&quot; ~ &quot;no&quot;,
      depev_a == &quot;7&quot; ~ &quot;refused&quot;,
      depev_a == &quot;8&quot; ~ &quot;not ascertained&quot;,
      depev_a == &quot;9&quot; ~ &quot;don&#39;t know&quot;
    ),
    
    pregnant = case_when(
      pregnow_a == &quot;1&quot; ~ &quot;yes&quot;,
      pregnow_a == &quot;2&quot; ~ &quot;no&quot;,
      pregnow_a == &quot;7&quot; ~ &quot;refused&quot;,
      pregnow_a == &quot;8&quot; ~ &quot;not ascertained&quot;,
      pregnow_a == &quot;9&quot; ~ &quot;don&#39;t know&quot;
    ),
    
    immune_weaken = case_when(
      hlthcond_a == &quot;1&quot; ~ &quot;yes&quot;,
      hlthcond_a == &quot;2&quot; ~ &quot;no&quot;,
      hlthcond_a == &quot;7&quot; ~ &quot;refused&quot;,
      hlthcond_a == &quot;8&quot; ~ &quot;not ascertained&quot;,
      hlthcond_a == &quot;9&quot; ~ &quot;don&#39;t know&quot;
    )
  )

adult = adult %&gt;%
  select(-sex_a, -agep_a, -smkcigst_a, -phstat_a, -educ_a, -hispallp_a, -hisdetp_a, -orient_a, -bmicat_a, -canev_a, -dibev_a, -dibtype_a, -copdev_a, -hypev_a, -strev_a, -astill_a, -chdev_a, -demenev_a, -hlthcond_a, -pregnow_a, -depev_a, -anxev_a, -disab3_a) %&gt;%
  relocate(year, smoke, sex, age, orient, education, race, hispanic_origin, disability, health, cancer, asthma, copd, dementia, diabetes_type, heart_disease, hypertention, anxiety, depression, bmi, pregnant, stroke, immune_weaken) %&gt;%
  mutate(
    diabetes_type = replace(diabetes_type, is.na(diabetes_type), &quot;missing&quot;),
    asthma = replace(asthma, is.na(asthma), &quot;missing&quot;),
    pregnant = replace(pregnant, is.na(pregnant), &quot;missing&quot;),
    immune_weaken = replace(immune_weaken, is.na(immune_weaken), &quot;missing&quot;)
  )</code></pre>
<p>#Making Plot</p>
<pre class="r"><code>adult=
  adult%&gt;%
  mutate(smoke = recode(smoke,&quot;current every day smoker&quot;=&quot;current smoker&quot;,&quot;current some day smoker&quot;=&quot;current smoker&quot;))%&gt;%
  drop_na()
  
 
adult</code></pre>
<pre><code>## # A tibble: 63,565 × 23
##     year smoke  sex      age orient education   race  hispanic_origin disability
##    &lt;dbl&gt; &lt;chr&gt;  &lt;chr&gt;  &lt;dbl&gt; &lt;chr&gt;  &lt;chr&gt;       &lt;chr&gt; &lt;chr&gt;           &lt;chr&gt;     
##  1  2019 never… male      97 strai… associate … blac… not hispanic    no        
##  2  2019 curre… female    28 strai… associate … white not hispanic    no        
##  3  2019 never… male      72 strai… some colle… white not hispanic    no        
##  4  2019 never… male      60 strai… associate … hisp… other hispanic  no        
##  5  2019 curre… male      60 strai… some colle… white not hispanic    no        
##  6  2019 never… male      78 strai… some colle… blac… not hispanic    no        
##  7  2019 never… male      32 strai… bachelor&#39;s… white not hispanic    no        
##  8  2019 curre… male      61 strai… high schoo… white not hispanic    no        
##  9  2019 never… male      28 strai… some colle… white not hispanic    no        
## 10  2019 forme… male      85 strai… grade 1-11  white not hispanic    no        
## # … with 63,555 more rows, and 14 more variables: health &lt;chr&gt;, cancer &lt;chr&gt;,
## #   asthma &lt;chr&gt;, copd &lt;chr&gt;, dementia &lt;chr&gt;, diabetes_type &lt;chr&gt;,
## #   heart_disease &lt;chr&gt;, hypertention &lt;chr&gt;, anxiety &lt;chr&gt;, depression &lt;chr&gt;,
## #   bmi &lt;chr&gt;, pregnant &lt;chr&gt;, stroke &lt;chr&gt;, immune_weaken &lt;chr&gt;</code></pre>
<pre class="r"><code>sex_df=
  adult%&gt;%
  group_by(smoke,sex,year)%&gt;%
  summarise(n=n())%&gt;%
  filter(sex%in%c(&quot;female&quot;,&quot;male&quot;))%&gt;%
  mutate(sex_year=str_c(sex,year))
sex_df</code></pre>
<pre><code>## # A tibble: 20 × 5
## # Groups:   smoke, sex [10]
##    smoke                          sex     year     n sex_year  
##    &lt;chr&gt;                          &lt;chr&gt;  &lt;dbl&gt; &lt;int&gt; &lt;chr&gt;     
##  1 current smoker                 female  2019  2096 female2019
##  2 current smoker                 female  2020  1751 female2020
##  3 current smoker                 male    2019  2199 male2019  
##  4 current smoker                 male    2020  1862 male2020  
##  5 former smoker                  female  2019  3709 female2019
##  6 former smoker                  female  2020  3811 female2020
##  7 former smoker                  male    2019  4263 male2019  
##  8 former smoker                  male    2020  4330 male2020  
##  9 never smoker                   female  2019 11016 female2019
## 10 never smoker                   female  2020 11150 female2020
## 11 never smoker                   male    2019  7914 male2019  
## 12 never smoker                   male    2020  8073 male2020  
## 13 smoker, current status unknown female  2019     3 female2019
## 14 smoker, current status unknown female  2020     4 female2020
## 15 smoker, current status unknown male    2019     4 male2019  
## 16 smoker, current status unknown male    2020     3 male2020  
## 17 unknown if ever smoked         female  2019   437 female2019
## 18 unknown if ever smoked         female  2020   329 female2020
## 19 unknown if ever smoked         male    2019   353 male2019  
## 20 unknown if ever smoked         male    2020   253 male2020</code></pre>
<pre class="r"><code>sex_df1=
  sex_df%&gt;%
  group_by(sex_year)%&gt;%
  summarise(sum=sum(n))

sex_df1</code></pre>
<pre><code>## # A tibble: 4 × 2
##   sex_year     sum
##   &lt;chr&gt;      &lt;int&gt;
## 1 female2019 17261
## 2 female2020 17045
## 3 male2019   14733
## 4 male2020   14521</code></pre>
<pre class="r"><code>sex_df1</code></pre>
<pre><code>## # A tibble: 4 × 2
##   sex_year     sum
##   &lt;chr&gt;      &lt;int&gt;
## 1 female2019 17261
## 2 female2020 17045
## 3 male2019   14733
## 4 male2020   14521</code></pre>
<pre class="r"><code>ggplot(sex_df,aes(fill=smoke,x=sex_year,group=sex))+
  geom_histogram(position=&quot;identity&quot;,stat=&quot;count&quot;)+
  labs(
    title=&quot;smokers by sex in 2019 and 2020&quot;,
    xlab=&quot;sex&quot;,
    ylab=&quot;value&quot;
  )</code></pre>
<p><img src="smoking_and_covid19_files/figure-html/unnamed-chunk-1-1.png" width="90%" /></p>
<pre class="r"><code>education_df=
  adult%&gt;%
  group_by(smoke,education,year)%&gt;%
  summarise(n=n())%&gt;%
  filter(education%in%c(&quot;never attended/kindergarten only&quot;,&quot;grade 1-11&quot;,&quot;12th grade, no diploma&quot;,&quot;GED or equivalent&quot;,&quot;high school graduate&quot;,&quot;some college, no degree&quot;,&quot;associate degree: occupational, technical, or vocational program&quot;,&quot;associate degree: academic program&quot;,&quot;bachelor&#39;s degree&quot;,&quot;master&#39;s degree&quot;,&quot;professional School degree&quot;,&quot;doctoral degree&quot;))%&gt;%
  mutate(education_year=str_c(education,year))
education_df</code></pre>
<pre><code>## # A tibble: 89 × 5
## # Groups:   smoke, education [45]
##    smoke          education                year     n education_year            
##    &lt;chr&gt;          &lt;chr&gt;                   &lt;dbl&gt; &lt;int&gt; &lt;chr&gt;                     
##  1 current smoker 12th grade, no diploma   2019   100 12th grade, no diploma2019
##  2 current smoker 12th grade, no diploma   2020    86 12th grade, no diploma2020
##  3 current smoker associate degree: occu…  2019   207 associate degree: occupat…
##  4 current smoker associate degree: occu…  2020   181 associate degree: occupat…
##  5 current smoker bachelor&#39;s degree        2019   491 bachelor&#39;s degree2019     
##  6 current smoker bachelor&#39;s degree        2020   448 bachelor&#39;s degree2020     
##  7 current smoker doctoral degree          2019    21 doctoral degree2019       
##  8 current smoker doctoral degree          2020    29 doctoral degree2020       
##  9 current smoker GED or equivalent        2019   261 GED or equivalent2019     
## 10 current smoker GED or equivalent        2020   208 GED or equivalent2020     
## # … with 79 more rows</code></pre>
<pre class="r"><code>ggplot(education_df,aes(fill=smoke,x=education_year,y=n))+
  geom_bar(position=&quot;stack&quot;, stat=&quot;identity&quot;)+
  labs(
    title=&quot;smokers by education in 2019 and 2020&quot;,
    xlab=&quot;education&quot;,
    ylab=&quot;value&quot;
  )+
  theme(axis.text.x=element_text(angle=45))</code></pre>
<p><img src="smoking_and_covid19_files/figure-html/unnamed-chunk-1-2.png" width="90%" /></p>
<pre class="r"><code>adult_smoke = 
  adult %&gt;%
  filter(smoke %in% c(&quot;current every day smoker&quot;, &quot;current some day smoker&quot;, &quot;former smoker&quot;, &quot;never smoker&quot;)) %&gt;%
  mutate(
    smoke = recode(smoke, &quot;current every day smoker&quot; = &quot;current smoker&quot;, &quot;current some day smoker&quot; = &quot;current smoker&quot;)
  ) %&gt;%
  mutate(
    sex = as.factor(sex),
    smoke = as.factor(smoke),
    orient = as.factor(orient),
    education = as.factor(education),
    race = as.factor(race),
    hispanic_origin = as.factor(hispanic_origin),
    disability = as.factor(disability),
    health = as.factor(health), 
    cancer = as.factor(cancer), 
    asthma = as.factor(asthma), 
    copd = as.factor(copd), 
    dementia = as.factor(dementia), 
    diabetes_type = as.factor(dementia), 
    heart_disease = as.factor(heart_disease), 
    hypertention = as.factor(hypertention), 
    anxiety = as.factor(anxiety), 
    depression = as.factor(depression), 
    bmi = as.factor(bmi), 
    pregnant = as.factor(pregnant), 
    stroke = as.factor(stroke), 
    immune_weaken = as.factor(immune_weaken)
  ) %&gt;%
  mutate(
    smoke = fct_relevel(smoke, &quot;current smoker&quot;, &quot;former smoker&quot;, &quot;never smoker&quot;)
  )</code></pre>
<pre class="r"><code>adult=
  adult%&gt;%
  mutate(smoke = recode(smoke,&quot;never smoker&quot;=&quot;never smoker&quot;,
      &quot;current every day smoker&quot;=&quot;current smoker&quot;,
      &quot;current some day smoker&quot;=&quot;current smoker&quot;,
      &quot;former smoker&quot;=&quot;former smoker&quot;,
  ))%&gt;%
  filter(smoke %in% c(&quot;current smoker&quot;,&quot;former smoker&quot;))

adult</code></pre>
<pre><code>## # A tibble: 24,024 × 23
##     year smoke  sex      age orient education   race  hispanic_origin disability
##    &lt;dbl&gt; &lt;chr&gt;  &lt;chr&gt;  &lt;dbl&gt; &lt;chr&gt;  &lt;chr&gt;       &lt;chr&gt; &lt;chr&gt;           &lt;chr&gt;     
##  1  2019 curre… female    28 strai… associate … white not hispanic    no        
##  2  2019 curre… male      60 strai… some colle… white not hispanic    no        
##  3  2019 curre… male      61 strai… high schoo… white not hispanic    no        
##  4  2019 forme… male      85 strai… grade 1-11  white not hispanic    no        
##  5  2019 curre… male      63 strai… high schoo… blac… not hispanic    no        
##  6  2019 curre… male      28 strai… high schoo… white not hispanic    no        
##  7  2019 curre… female    26 strai… associate … white not hispanic    no        
##  8  2019 curre… female    25 strai… some colle… white not hispanic    no        
##  9  2019 forme… male      57 strai… bachelor&#39;s… white not hispanic    no        
## 10  2019 forme… female    75 strai… bachelor&#39;s… white not hispanic    no        
## # … with 24,014 more rows, and 14 more variables: health &lt;chr&gt;, cancer &lt;chr&gt;,
## #   asthma &lt;chr&gt;, copd &lt;chr&gt;, dementia &lt;chr&gt;, diabetes_type &lt;chr&gt;,
## #   heart_disease &lt;chr&gt;, hypertention &lt;chr&gt;, anxiety &lt;chr&gt;, depression &lt;chr&gt;,
## #   bmi &lt;chr&gt;, pregnant &lt;chr&gt;, stroke &lt;chr&gt;, immune_weaken &lt;chr&gt;</code></pre>
<pre class="r"><code>sex_df=
  adult%&gt;%
  group_by(smoke,sex)%&gt;%
  summarise(n=n())%&gt;%
  filter(sex%in%c(&quot;female&quot;,&quot;male&quot;))%&gt;%
  group_by(sex)%&gt;%
  mutate(sum=sum(n))%&gt;%
  mutate(percentage=n/sum)


sex_df</code></pre>
<pre><code>## # A tibble: 4 × 5
## # Groups:   sex [2]
##   smoke          sex        n   sum percentage
##   &lt;chr&gt;          &lt;chr&gt;  &lt;int&gt; &lt;int&gt;      &lt;dbl&gt;
## 1 current smoker female  3847 11367      0.338
## 2 current smoker male    4061 12654      0.321
## 3 former smoker  female  7520 11367      0.662
## 4 former smoker  male    8593 12654      0.679</code></pre>
<pre class="r"><code>ggplot(sex_df,aes(fill=smoke,x=sex,y=percentage))+
  geom_bar(position=&quot;stack&quot;, stat=&quot;identity&quot;)+
  labs(
    title=&quot;smokers by sex&quot;,
    x=&quot;sex&quot;,
    y=&quot;value&quot;
  )+
  theme(text=element_text(size=18),axis.text.x=element_text(angle=45))</code></pre>
<p><img src="smoking_and_covid19_files/figure-html/unnamed-chunk-2-1.png" width="90%" /></p>
<pre class="r"><code>education_df=
  adult%&gt;%
  group_by(smoke,education)%&gt;%
  summarise(n=n())%&gt;%
  filter(education%in%c(&quot;never attended/kindergarten only&quot;,&quot;grade 1-11&quot;,&quot;12th grade, no diploma&quot;,&quot;GED or equivalent&quot;,&quot;high school graduate&quot;,&quot;some college, no degree&quot;,&quot;associate degree:occupational...&quot;,&quot;associate degree: academic&quot;,&quot;bachelor&#39;s degree&quot;,&quot;doctoral degree&quot;))%&gt;%
  group_by(education)%&gt;%
  mutate(sum=sum(n))%&gt;%
  mutate(percentage=n/sum)
education_df</code></pre>
<pre><code>## # A tibble: 18 × 5
## # Groups:   education [9]
##    smoke          education                            n   sum percentage
##    &lt;chr&gt;          &lt;chr&gt;                            &lt;int&gt; &lt;int&gt;      &lt;dbl&gt;
##  1 current smoker 12th grade, no diploma             186   373      0.499
##  2 current smoker associate degree: academic         725  2315      0.313
##  3 current smoker bachelor&#39;s degree                  939  4129      0.227
##  4 current smoker doctoral degree                     50   327      0.153
##  5 current smoker GED or equivalent                  469   956      0.491
##  6 current smoker grade 1-11                         908  2015      0.451
##  7 current smoker high school graduate              2397  6286      0.381
##  8 current smoker never attended/kindergarten only    13    32      0.406
##  9 current smoker some college, no degree           1479  4246      0.348
## 10 former smoker  12th grade, no diploma             187   373      0.501
## 11 former smoker  associate degree: academic        1590  2315      0.687
## 12 former smoker  bachelor&#39;s degree                 3190  4129      0.773
## 13 former smoker  doctoral degree                    277   327      0.847
## 14 former smoker  GED or equivalent                  487   956      0.509
## 15 former smoker  grade 1-11                        1107  2015      0.549
## 16 former smoker  high school graduate              3889  6286      0.619
## 17 former smoker  never attended/kindergarten only    19    32      0.594
## 18 former smoker  some college, no degree           2767  4246      0.652</code></pre>
<pre class="r"><code>ggplot(education_df,aes(fill=smoke,x=education,y=percentage))+
  geom_bar(position=&quot;stack&quot;, stat=&quot;identity&quot;)+
  labs(
    title=&quot;smokers by education&quot;,
    x=&quot;education&quot;,
    y=&quot;value&quot;
  )+
  theme(text=element_text(size=18),axis.text.x=element_text(angle=45))</code></pre>
<p><img src="smoking_and_covid19_files/figure-html/unnamed-chunk-2-2.png" width="90%" /></p>
<pre class="r"><code>age_df=
  adult%&gt;%
  mutate(age1=ifelse(age&lt;=18,&quot;0-18 years old&quot;,ifelse(age&lt;=21,&quot;18-21 years old&quot;,ifelse(age&lt;=65,&quot;21-65 years old&quot;,&quot;above 65 years old&quot;))))%&gt;%
  group_by(smoke,age1)%&gt;%
  summarise(n=n())%&gt;%
  group_by(age1)%&gt;%
  mutate(sum=sum(n))%&gt;%
  mutate(percentage=n/sum)
age_df</code></pre>
<pre><code>## # A tibble: 8 × 5
## # Groups:   age1 [4]
##   smoke          age1                   n   sum percentage
##   &lt;chr&gt;          &lt;chr&gt;              &lt;int&gt; &lt;int&gt;      &lt;dbl&gt;
## 1 current smoker 0-18 years old        16    21      0.762
## 2 current smoker 18-21 years old       98   152      0.645
## 3 current smoker 21-65 years old     6422 15464      0.415
## 4 current smoker above 65 years old  1373  8387      0.164
## 5 former smoker  0-18 years old         5    21      0.238
## 6 former smoker  18-21 years old       54   152      0.355
## 7 former smoker  21-65 years old     9042 15464      0.585
## 8 former smoker  above 65 years old  7014  8387      0.836</code></pre>
<pre class="r"><code>ggplot(age_df,aes(fill=smoke,x=age1,y=percentage))+
  geom_bar(position=&quot;stack&quot;, stat=&quot;identity&quot;)+
  labs(
    title=&quot;smokers by age&quot;,
    x=&quot;age&quot;,
    y=&quot;value&quot;
  )+
  theme(text=element_text(size=18),axis.text.x=element_text(angle=45))</code></pre>
<p><img src="smoking_and_covid19_files/figure-html/unnamed-chunk-2-3.png" width="90%" /></p>
<pre class="r"><code>health_status_df=
  adult%&gt;%
  filter(health%in%c(&quot;excellent&quot;,&quot;vert good&quot;,&quot;good&quot;,&quot;fair&quot;,&quot;poor&quot;))%&gt;%
  group_by(smoke,health)%&gt;%
  summarise(n=n())%&gt;%
  group_by(health)%&gt;%
  mutate(sum=sum(n))%&gt;%
  mutate(percentage=n/sum)

ggplot(health_status_df,aes(fill=smoke,x=health,y=percentage))+
  geom_bar(position=&quot;stack&quot;, stat=&quot;identity&quot;)+
  labs(
    title=&quot;smokers by health&quot;,
    x=&quot;health&quot;,
    y=&quot;value&quot;
  )+
  theme(text=element_text(size=18),axis.text.x=element_text(angle=45))</code></pre>
<p><img src="smoking_and_covid19_files/figure-html/unnamed-chunk-2-4.png" width="90%" /></p>
<pre class="r"><code>race_df=
  adult%&gt;%
  group_by(smoke,race)%&gt;%
  summarise(n=n())%&gt;%
  group_by(race)%&gt;%
  mutate(sum=sum(n))%&gt;%
  mutate(percentage=n/sum)

ggplot(race_df,aes(fill=smoke,x=race,y=percentage))+
  geom_bar(position=&quot;stack&quot;, stat=&quot;identity&quot;)+
  labs(
    title=&quot;smokers by race&quot;,
    x=&quot;race&quot;,
    y=&quot;value&quot;
  )+
  theme(text=element_text(size=18),axis.text.x=element_text(angle=45))</code></pre>
<p><img src="smoking_and_covid19_files/figure-html/unnamed-chunk-2-5.png" width="90%" /></p>
<pre class="r"><code>disability_df=
  adult%&gt;%
  filter(disability!=&quot;don&#39;t know&quot;)%&gt;%
  group_by(smoke,disability)%&gt;%
  summarise(n=n())%&gt;%
  group_by(disability)%&gt;%
  mutate(sum=sum(n))%&gt;%
  mutate(percentage=n/sum)
  
ggplot(disability_df,aes(fill=smoke,x=disability,y=percentage))+
  geom_bar(position=&quot;stack&quot;, stat=&quot;identity&quot;)+
  labs(
    title=&quot;smokers by disability&quot;,
    x=&quot;disability&quot;,
    y=&quot;value&quot;
  )+
  theme(text=element_text(size=18),axis.text.x=element_text(angle=45))</code></pre>
<p><img src="smoking_and_covid19_files/figure-html/unnamed-chunk-2-6.png" width="90%" /></p>
<pre class="r"><code>orient_df=
  adult%&gt;%
  filter(!orient%in%c(&quot;not ascertained&quot;,&quot;refused&quot;,&quot;unknown&quot;))%&gt;%
  group_by(smoke,orient)%&gt;%
  summarise(n=n())%&gt;%
  group_by(orient)%&gt;%
  mutate(sum=sum(n))%&gt;%
  mutate(percentage=n/sum)
  
ggplot(orient_df,aes(fill=smoke,x=orient,y=percentage))+
  geom_bar(position=&quot;stack&quot;, stat=&quot;identity&quot;)+
  labs(
    title=&quot;smokers by orient&quot;,
    x=&quot;orient&quot;,
    y=&quot;value&quot;
  )+
  theme(text=element_text(size=18),axis.text.x=element_text(angle=45))  </code></pre>
<p><img src="smoking_and_covid19_files/figure-html/unnamed-chunk-2-7.png" width="90%" /></p>
<pre class="r"><code>immune_weaken_df=
  adult%&gt;%
  filter(!immune_weaken%in%c(&quot;not ascertained&quot;,&quot;refused&quot;,&quot;don&#39;t know&quot;,&quot;missing&quot;))%&gt;%
  group_by(smoke,immune_weaken)%&gt;%
  summarise(n=n())%&gt;%
  group_by(immune_weaken)%&gt;%
  mutate(sum=sum(n))%&gt;%
  mutate(percentage=n/sum)
  
ggplot(immune_weaken_df,aes(fill=smoke,x=immune_weaken,y=percentage))+
  geom_bar(position=&quot;stack&quot;, stat=&quot;identity&quot;)+
  labs(
    title=&quot;smokers by immune weaken&quot;,
    x=&quot;immune weaken&quot;,
    y=&quot;value&quot;
  )+
  theme(text=element_text(size=18),axis.text.x=element_text(angle=45))</code></pre>
<p><img src="smoking_and_covid19_files/figure-html/unnamed-chunk-2-8.png" width="90%" /></p>
<pre class="r"><code>#Cancer
cancer_df=
  adult%&gt;%
  group_by(year,smoke,cancer)%&gt;%
  filter(!cancer%in%c(&quot;don&#39;t know&quot;,&quot;refused&quot;,&quot;no&quot;))%&gt;%
  summarise(n=n())%&gt;%
  mutate(cancer_year=str_c(cancer,year))%&gt;%
  group_by(cancer_year)%&gt;%
  mutate(sum=sum(n))%&gt;%
  mutate(percentage=n/sum)
cancer_df</code></pre>
<pre><code>## # A tibble: 4 × 7
## # Groups:   cancer_year [2]
##    year smoke          cancer     n cancer_year   sum percentage
##   &lt;dbl&gt; &lt;chr&gt;          &lt;chr&gt;  &lt;int&gt; &lt;chr&gt;       &lt;int&gt;      &lt;dbl&gt;
## 1  2019 current smoker yes      438 yes2019      1828      0.240
## 2  2019 former smoker  yes     1390 yes2019      1828      0.760
## 3  2020 current smoker yes      380 yes2020      1923      0.198
## 4  2020 former smoker  yes     1543 yes2020      1923      0.802</code></pre>
<pre class="r"><code>ggplot(cancer_df,aes(fill=smoke,x=cancer_year,y=percentage))+
  geom_bar(position=&quot;stack&quot;, stat=&quot;identity&quot;)+
  labs(
    title=&quot;smokers by cancer in 2019 and 2020&quot;,
    x=&quot;cancer&quot;,
    y=&quot;value&quot;
  )+
  theme(text=element_text(size=18),axis.text.x=element_text(angle=45))</code></pre>
<p><img src="smoking_and_covid19_files/figure-html/unnamed-chunk-3-1.png" width="90%" /></p>
<pre class="r"><code>#Diabetes type
diabetes_df=
  adult%&gt;%
  mutate(diabetes_type=recode(diabetes_type,&quot;type 1&quot;=&quot;diabetes&quot;,&quot;type 2&quot;=&quot;diabetes&quot;))%&gt;%
  group_by(year,smoke,diabetes_type)%&gt;%
  filter(!diabetes_type%in%c(&quot;don&#39;t know&quot;,&quot;refused&quot;,&quot;missing&quot;,&quot;other&quot;))%&gt;%
  summarise(n=n())%&gt;%
  mutate(diabetes_year=str_c(diabetes_type,year))%&gt;%
  group_by(diabetes_year)%&gt;%
  mutate(sum=sum(n))%&gt;%
  mutate(percentage=n/sum)
diabetes_df</code></pre>
<pre><code>## # A tibble: 4 × 7
## # Groups:   diabetes_year [2]
##    year smoke          diabetes_type     n diabetes_year   sum percentage
##   &lt;dbl&gt; &lt;chr&gt;          &lt;chr&gt;         &lt;int&gt; &lt;chr&gt;         &lt;int&gt;      &lt;dbl&gt;
## 1  2019 current smoker diabetes        366 diabetes2019   1414      0.259
## 2  2019 former smoker  diabetes       1048 diabetes2019   1414      0.741
## 3  2020 current smoker diabetes        356 diabetes2020   1402      0.254
## 4  2020 former smoker  diabetes       1046 diabetes2020   1402      0.746</code></pre>
<pre class="r"><code>ggplot(diabetes_df,aes(fill=smoke,x=diabetes_year,y=percentage))+
  geom_bar(position=&quot;stack&quot;, stat=&quot;identity&quot;)+
  labs(
    title=&quot;smokers by diabetes in 2019 and 2020&quot;,
    x=&quot;diabetes&quot;,
    y=&quot;value&quot;
  )+
  theme(text=element_text(size=18),axis.text.x=element_text(angle=45))</code></pre>
<p><img src="smoking_and_covid19_files/figure-html/unnamed-chunk-3-2.png" width="90%" /></p>
<pre class="r"><code>#COP
cop_df=
  adult%&gt;%
  group_by(year,smoke,copd)%&gt;%
  filter(!copd%in%c(&quot;don&#39;t know&quot;,&quot;refused&quot;,&quot;missing&quot;,&quot;no&quot;))%&gt;%
  summarise(n=n())%&gt;%
  mutate(copd_year=str_c(copd,year))%&gt;%
  group_by(copd_year)%&gt;%
  mutate(sum=sum(n))%&gt;%
  mutate(percentage=n/sum)
cop_df</code></pre>
<pre><code>## # A tibble: 4 × 7
## # Groups:   copd_year [2]
##    year smoke          copd      n copd_year   sum percentage
##   &lt;dbl&gt; &lt;chr&gt;          &lt;chr&gt; &lt;int&gt; &lt;chr&gt;     &lt;int&gt;      &lt;dbl&gt;
## 1  2019 current smoker yes     578 yes2019    1366      0.423
## 2  2019 former smoker  yes     788 yes2019    1366      0.577
## 3  2020 current smoker yes     530 yes2020    1383      0.383
## 4  2020 former smoker  yes     853 yes2020    1383      0.617</code></pre>
<pre class="r"><code>ggplot(cop_df,aes(fill=smoke,x=copd_year,y=percentage))+
  geom_bar(position=&quot;stack&quot;, stat=&quot;identity&quot;)+
  labs(
    title=&quot;smokers by COPD in 2019 and 2020&quot;,
    x=&quot;COPD&quot;,
    y=&quot;value&quot;
  )+
  theme(text=element_text(size=18),axis.text.x=element_text(angle=45))</code></pre>
<p><img src="smoking_and_covid19_files/figure-html/unnamed-chunk-4-1.png" width="90%" /></p>
<pre class="r"><code>hypev_df=
  adult%&gt;%
  group_by(year,smoke,hypertention)%&gt;%
  filter(!hypertention%in%c(&quot;don&#39;t know&quot;,&quot;refused&quot;,&quot;missing&quot;,&quot;no&quot;))%&gt;%
  summarise(n=n())%&gt;%
  mutate(hypertention_year=str_c(hypertention,year))%&gt;%
  group_by(hypertention_year)%&gt;%
  mutate(sum=sum(n))%&gt;%
  mutate(percentage=n/sum)
hypev_df</code></pre>
<pre><code>## # A tibble: 4 × 7
## # Groups:   hypertention_year [2]
##    year smoke          hypertention     n hypertention_year   sum percentage
##   &lt;dbl&gt; &lt;chr&gt;          &lt;chr&gt;        &lt;int&gt; &lt;chr&gt;             &lt;int&gt;      &lt;dbl&gt;
## 1  2019 current smoker yes           1598 yes2019            5293      0.302
## 2  2019 former smoker  yes           3695 yes2019            5293      0.698
## 3  2020 current smoker yes           1413 yes2020            5213      0.271
## 4  2020 former smoker  yes           3800 yes2020            5213      0.729</code></pre>
<pre class="r"><code>ggplot(hypev_df,aes(fill=smoke,x=hypertention_year,y=percentage))+
  geom_bar(position=&quot;stack&quot;, stat=&quot;identity&quot;)+
  labs(
    title=&quot;smokers by hypertention in 2019 and 2020&quot;,
    x=&quot;hypertention&quot;,
    y=&quot;value&quot;
  )+
  theme(text=element_text(size=18),axis.text.x=element_text(angle=45))</code></pre>
<p><img src="smoking_and_covid19_files/figure-html/unnamed-chunk-4-2.png" width="90%" /></p>
<pre class="r"><code>#Stroke
stroke_df=
  adult%&gt;%
  group_by(year,smoke,stroke)%&gt;%
  filter(!stroke%in%c(&quot;don&#39;t know&quot;,&quot;refused&quot;,&quot;missing&quot;,&quot;no&quot;))%&gt;%
  summarise(n=n())%&gt;%
  mutate(stroke_year=str_c(stroke,year))%&gt;%
  group_by(stroke_year)%&gt;%
  mutate(sum=sum(n))%&gt;%
  mutate(percentage=n/sum)
stroke_df</code></pre>
<pre><code>## # A tibble: 4 × 7
## # Groups:   stroke_year [2]
##    year smoke          stroke     n stroke_year   sum percentage
##   &lt;dbl&gt; &lt;chr&gt;          &lt;chr&gt;  &lt;int&gt; &lt;chr&gt;       &lt;int&gt;      &lt;dbl&gt;
## 1  2019 current smoker yes      209 yes2019       659      0.317
## 2  2019 former smoker  yes      450 yes2019       659      0.683
## 3  2020 current smoker yes      177 yes2020       566      0.313
## 4  2020 former smoker  yes      389 yes2020       566      0.687</code></pre>
<pre class="r"><code>ggplot(stroke_df,aes(fill=smoke,x=stroke_year,y=percentage))+
  geom_bar(position=&quot;stack&quot;, stat=&quot;identity&quot;)+
  labs(
    title=&quot;smokers by stroke in 2019 and 2020&quot;,
    x=&quot;stroke&quot;,
    y=&quot;value&quot;
  )+
  theme(text=element_text(size=18),axis.text.x=element_text(angle=45))</code></pre>
<p><img src="smoking_and_covid19_files/figure-html/unnamed-chunk-5-1.png" width="90%" /></p>
<pre class="r"><code>#Asthma
asthma_df=
  adult%&gt;%
  group_by(year,smoke,asthma)%&gt;%
  filter(!asthma%in%c(&quot;don&#39;t know&quot;,&quot;refused&quot;,&quot;missing&quot;,&quot;no&quot;))%&gt;%
  summarise(n=n())%&gt;%
  mutate(asthma_year=str_c(asthma,year))%&gt;%
  group_by(asthma_year)%&gt;%
  mutate(sum=sum(n))%&gt;%
  mutate(percentage=n/sum)
asthma_df</code></pre>
<pre><code>## # A tibble: 4 × 7
## # Groups:   asthma_year [2]
##    year smoke          asthma     n asthma_year   sum percentage
##   &lt;dbl&gt; &lt;chr&gt;          &lt;chr&gt;  &lt;int&gt; &lt;chr&gt;       &lt;int&gt;      &lt;dbl&gt;
## 1  2019 current smoker yes      468 yes2019      1133      0.413
## 2  2019 former smoker  yes      665 yes2019      1133      0.587
## 3  2020 current smoker yes      340 yes2020      1041      0.327
## 4  2020 former smoker  yes      701 yes2020      1041      0.673</code></pre>
<pre class="r"><code>ggplot(asthma_df,aes(fill=smoke,x=asthma_year,y=percentage))+
  geom_bar(position=&quot;stack&quot;, stat=&quot;identity&quot;)+
  labs(
    title=&quot;smokers by asthma in 2019 and 2020&quot;,
    x=&quot;asthma&quot;,
    y=&quot;value&quot;
  )+
  theme(text=element_text(size=18),axis.text.x=element_text(angle=45))</code></pre>
<p><img src="smoking_and_covid19_files/figure-html/unnamed-chunk-5-2.png" width="90%" /></p>
<pre class="r"><code>#Dementia
dementia_df=
  adult%&gt;%
  group_by(year,smoke,dementia)%&gt;%
  filter(!dementia%in%c(&quot;don&#39;t know&quot;,&quot;refused&quot;,&quot;missing&quot;,&quot;no&quot;))%&gt;%
  summarise(n=n())%&gt;%
  mutate(dementia_year=str_c(dementia,year))%&gt;%
  group_by(dementia_year)%&gt;%
  mutate(sum=sum(n))%&gt;%
  mutate(percentage=n/sum)
dementia_df</code></pre>
<pre><code>## # A tibble: 4 × 7
## # Groups:   dementia_year [2]
##    year smoke          dementia     n dementia_year   sum percentage
##   &lt;dbl&gt; &lt;chr&gt;          &lt;chr&gt;    &lt;int&gt; &lt;chr&gt;         &lt;int&gt;      &lt;dbl&gt;
## 1  2019 current smoker yes         29 yes2019         153      0.190
## 2  2019 former smoker  yes        124 yes2019         153      0.810
## 3  2020 current smoker yes         32 yes2020         134      0.239
## 4  2020 former smoker  yes        102 yes2020         134      0.761</code></pre>
<pre class="r"><code>ggplot(dementia_df,aes(fill=smoke,x=dementia_year,y=percentage))+
  geom_bar(position=&quot;stack&quot;, stat=&quot;identity&quot;)+
  labs(
    title=&quot;smokers by dementia in 2019 and 2020&quot;,
    x=&quot;dementia&quot;,
    y=&quot;value&quot;
  )+
  theme(text=element_text(size=18),axis.text.x=element_text(angle=45))</code></pre>
<p><img src="smoking_and_covid19_files/figure-html/unnamed-chunk-5-3.png" width="90%" /></p>
<pre class="r"><code># Heart Disease
heart_disease_df=
  adult%&gt;%
  group_by(year,smoke,heart_disease)%&gt;%
  filter(!heart_disease%in%c(&quot;don&#39;t know&quot;,&quot;refused&quot;,&quot;missing&quot;,&quot;no&quot;))%&gt;%
  summarise(n=n())%&gt;%
  mutate(heart_disease_year=str_c(heart_disease,year))%&gt;%
  group_by(heart_disease_year)%&gt;%
  mutate(sum=sum(n))%&gt;%
  mutate(percentage=n/sum)
heart_disease_df</code></pre>
<pre><code>## # A tibble: 4 × 7
## # Groups:   heart_disease_year [2]
##    year smoke          heart_disease     n heart_disease_year   sum percentage
##   &lt;dbl&gt; &lt;chr&gt;          &lt;chr&gt;         &lt;int&gt; &lt;chr&gt;              &lt;int&gt;      &lt;dbl&gt;
## 1  2019 current smoker yes             226 yes2019             1044      0.216
## 2  2019 former smoker  yes             818 yes2019             1044      0.784
## 3  2020 current smoker yes             190 yes2020             1068      0.178
## 4  2020 former smoker  yes             878 yes2020             1068      0.822</code></pre>
<pre class="r"><code>ggplot(heart_disease_df,aes(fill=smoke,x=heart_disease_year,y=percentage))+
  geom_bar(position=&quot;stack&quot;, stat=&quot;identity&quot;)+
  labs(
    title=&quot;smokers by heart disease in 2019 and 2020&quot;,
    x=&quot;heart disease&quot;,
    y=&quot;value&quot;
  )+
  theme(text=element_text(size=18),axis.text.x=element_text(angle=45))</code></pre>
<p><img src="smoking_and_covid19_files/figure-html/unnamed-chunk-5-4.png" width="90%" /></p>
<pre class="r"><code>#Anxiety
anxiety_df=
  adult%&gt;%
  group_by(year,smoke,anxiety)%&gt;%
  filter(!anxiety%in%c(&quot;don&#39;t know&quot;,&quot;refused&quot;,&quot;missing&quot;,&quot;no&quot;))%&gt;%
  summarise(n=n())%&gt;%
  mutate(anxiety_year=str_c(anxiety,year))%&gt;%
  group_by(anxiety_year)%&gt;%
  mutate(sum=sum(n))%&gt;%
  mutate(percentage=n/sum)
anxiety_df</code></pre>
<pre><code>## # A tibble: 4 × 7
## # Groups:   anxiety_year [2]
##    year smoke          anxiety     n anxiety_year   sum percentage
##   &lt;dbl&gt; &lt;chr&gt;          &lt;chr&gt;   &lt;int&gt; &lt;chr&gt;        &lt;int&gt;      &lt;dbl&gt;
## 1  2019 current smoker yes      1059 yes2019       2402      0.441
## 2  2019 former smoker  yes      1343 yes2019       2402      0.559
## 3  2020 current smoker yes       903 yes2020       2284      0.395
## 4  2020 former smoker  yes      1381 yes2020       2284      0.605</code></pre>
<pre class="r"><code>ggplot(anxiety_df,aes(fill=smoke,x=anxiety_year,y=percentage))+
  geom_bar(position=&quot;stack&quot;, stat=&quot;identity&quot;)+
  labs(
    title=&quot;smokers by anxiety in 2019 and 2020&quot;,
    x=&quot;anxiety&quot;,
    y=&quot;value&quot;
  )+
  theme(text=element_text(size=18),axis.text.x=element_text(angle=45))</code></pre>
<p><img src="smoking_and_covid19_files/figure-html/unnamed-chunk-6-1.png" width="90%" /></p>
<pre class="r"><code>#Depression
depression_df=
  adult%&gt;%
  group_by(year,smoke,depression)%&gt;%
  filter(!depression%in%c(&quot;don&#39;t know&quot;,&quot;refused&quot;,&quot;missing&quot;,&quot;no&quot;))%&gt;%
  summarise(n=n())%&gt;%
  mutate(depression_year=str_c(depression,year))%&gt;%
  group_by(depression_year)%&gt;%
  mutate(sum=sum(n))%&gt;%
  mutate(percentage=n/sum)
depression_df</code></pre>
<pre><code>## # A tibble: 4 × 7
## # Groups:   depression_year [2]
##    year smoke          depression     n depression_year   sum percentage
##   &lt;dbl&gt; &lt;chr&gt;          &lt;chr&gt;      &lt;int&gt; &lt;chr&gt;           &lt;int&gt;      &lt;dbl&gt;
## 1  2019 current smoker yes         1189 yes2019          2757      0.431
## 2  2019 former smoker  yes         1568 yes2019          2757      0.569
## 3  2020 current smoker yes         1001 yes2020          2599      0.385
## 4  2020 former smoker  yes         1598 yes2020          2599      0.615</code></pre>
<pre class="r"><code>ggplot(depression_df,aes(fill=smoke,x=depression_year,y=percentage))+
  geom_bar(position=&quot;stack&quot;, stat=&quot;identity&quot;)+
  labs(
    title=&quot;smokers by depression in 2019 and 2020&quot;,
    x=&quot;depression&quot;,
    y=&quot;value&quot;
  )+
  theme(text=element_text(size=18),axis.text.x=element_text(angle=45))</code></pre>
<p><img src="smoking_and_covid19_files/figure-html/unnamed-chunk-6-2.png" width="90%" /></p>
<pre class="r"><code>#Bmi
bmi_df=
  adult%&gt;%
  group_by(year,smoke,bmi)%&gt;%
  filter(!bmi%in%c(&quot;don&#39;t know&quot;,&quot;refused&quot;,&quot;missing&quot;,&quot;unknown&quot;,&quot;no&quot;))%&gt;%
  summarise(n=n())%&gt;%
  mutate(bmi_year=str_c(bmi,year))%&gt;%
  group_by(bmi_year)%&gt;%
  mutate(sum=sum(n))%&gt;%
  mutate(percentage=n/sum)
bmi_df</code></pre>
<pre><code>## # A tibble: 16 × 7
## # Groups:   bmi_year [8]
##     year smoke          bmi                n bmi_year             sum percentage
##    &lt;dbl&gt; &lt;chr&gt;          &lt;chr&gt;          &lt;int&gt; &lt;chr&gt;              &lt;int&gt;      &lt;dbl&gt;
##  1  2019 current smoker healthy weight  1459 healthy weight2019  3573      0.408
##  2  2019 current smoker obese           1278 obese2019           4013      0.318
##  3  2019 current smoker overweight      1370 overweight2019      4217      0.325
##  4  2019 current smoker underweight       95 underweight2019      187      0.508
##  5  2019 former smoker  healthy weight  2114 healthy weight2019  3573      0.592
##  6  2019 former smoker  obese           2735 obese2019           4013      0.682
##  7  2019 former smoker  overweight      2847 overweight2019      4217      0.675
##  8  2019 former smoker  underweight       92 underweight2019      187      0.492
##  9  2020 current smoker healthy weight  1178 healthy weight2020  3354      0.351
## 10  2020 current smoker obese           1108 obese2020           3897      0.284
## 11  2020 current smoker overweight      1174 overweight2020      4104      0.286
## 12  2020 current smoker underweight       90 underweight2020      175      0.514
## 13  2020 former smoker  healthy weight  2176 healthy weight2020  3354      0.649
## 14  2020 former smoker  obese           2789 obese2020           3897      0.716
## 15  2020 former smoker  overweight      2930 overweight2020      4104      0.714
## 16  2020 former smoker  underweight       85 underweight2020      175      0.486</code></pre>
<pre class="r"><code>ggplot(bmi_df,aes(fill=smoke,x=bmi_year,y=percentage))+
  geom_bar(position=&quot;stack&quot;, stat=&quot;identity&quot;)+
  labs(
    title=&quot;smokers by bmi in 2019 and 2020&quot;,
    x=&quot;bmi&quot;,
    y=&quot;value&quot;
  )+
  theme(text=element_text(size=18),axis.text.x=element_text(angle=45))</code></pre>
<p><img src="smoking_and_covid19_files/figure-html/unnamed-chunk-7-1.png" width="90%" /></p>
<pre class="r"><code>#Pregnant
pregnant_df=
  adult%&gt;%
  group_by(year,smoke,pregnant)%&gt;%
  filter(!pregnant%in%c(&quot;don&#39;t know&quot;,&quot;refused&quot;,&quot;missing&quot;,&quot;unknown&quot;,&quot;no&quot;,&quot;not ascertained&quot;))%&gt;%
  summarise(n=n())%&gt;%
  mutate(pregnant_year=str_c(pregnant,year))%&gt;%
  group_by(pregnant_year)%&gt;%
  mutate(sum=sum(n))%&gt;%
  mutate(percentage=n/sum)
pregnant_df</code></pre>
<pre><code>## # A tibble: 4 × 7
## # Groups:   pregnant_year [2]
##    year smoke          pregnant     n pregnant_year   sum percentage
##   &lt;dbl&gt; &lt;chr&gt;          &lt;chr&gt;    &lt;int&gt; &lt;chr&gt;         &lt;int&gt;      &lt;dbl&gt;
## 1  2019 current smoker yes         13 yes2019          53      0.245
## 2  2019 former smoker  yes         40 yes2019          53      0.755
## 3  2020 current smoker yes         12 yes2020          40      0.3  
## 4  2020 former smoker  yes         28 yes2020          40      0.7</code></pre>
<pre class="r"><code>ggplot(pregnant_df,aes(fill=smoke,x=pregnant_year,y=percentage))+
  geom_bar(position=&quot;stack&quot;, stat=&quot;identity&quot;)+
  labs(
    title=&quot;smokers by pregnant in 2019 and 2020&quot;,
    x=&quot;pregnant&quot;,
    y=&quot;value&quot;
  )+
  theme(text=element_text(size=18),axis.text.x=element_text(angle=45))</code></pre>
<p><img src="smoking_and_covid19_files/figure-html/unnamed-chunk-7-2.png" width="90%" /></p>
</div>




</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
